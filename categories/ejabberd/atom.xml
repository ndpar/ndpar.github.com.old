<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ejabberd | Side Notes]]></title>
  <link href="http://blog.ndpar.com/categories/ejabberd/atom.xml" rel="self"/>
  <link href="http://blog.ndpar.com/"/>
  <updated>2013-06-02T10:35:21-04:00</updated>
  <id>http://blog.ndpar.com/</id>
  <author>
    <name><![CDATA[Andrey Paramonov]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Get started with ejabberd]]></title>
    <link href="http://blog.ndpar.com/2010/02/23/get-started-with-ejabberd/"/>
    <updated>2010-02-23T07:00:00-05:00</updated>
    <id>http://blog.ndpar.com/2010/02/23/get-started-with-ejabberd</id>
    <content type="html"><![CDATA[<h2>Installation</h2>

<p>Before installing ejabberd make sure you have Erlang environment set up. Run the following command and verify the output</p>

<pre><code>$ erl -version
Erlang (ASYNC_THREADS,HIPE) (BEAM) emulator version 5.10.1
</code></pre>

<p>I used to install ejabberd with apt-get command, which is convenient but always several versions behind. That&rsquo;s why I switched to building from sources. All scripts below should be run under <em>ejabberd</em> user.</p>

<p>First, create a directory where all ejabberd versions will be installed, if it does not exist yet</p>

<pre><code>$ sudo mkdir /opt/ejabberd
$ sudo chown -R ejabberd /opt/ejabberd
</code></pre>

<p>Download the sources</p>

<pre><code>$ git clone git@github.com:processone/ejabberd.git
$ cd ejabberd
</code></pre>

<p>Assuming we want to install version 2.1.x</p>

<pre><code>$ git checkout 2.1.x
$ cd src
$ ./configure --prefix=/opt/ejabberd/ejabberd-2.1.12 --enable-user=ejabberd
</code></pre>

<p>To see all available options, run <code>./configure --help</code>.</p>

<pre><code>$ make
$ make install
$ cd /opt/ejabberd
$ ln -s ejabberd-2.1.12 ejabberd
</code></pre>

<h2>Configuration</h2>

<p>Ejabberd comes with reasonable default configuration. Only two lines of configuration need to be changed to make it work in your environment. Open <em>/opt/ejabberd/ejabberd/etc/ejabberd/ejabberd.cfg</em> file and find <em>SERVED HOSTNAMES</em> section. By default Ejabberd listens to localhost only. Update this line with your machine&rsquo;s host names. I usually add the short name and the long name. You can find them by running <code>hostname -s</code> and <code>hostname -A</code> commands. Here is what I have in my config</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>/opt/ejabberd/ejabberd/etc/ejabberd/ejabberd.cfg </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="c">%%%&amp;lsquo;   SERVED HOSTNAMES</span>
</span><span class='line'><span class="p">{</span><span class="n">hosts</span><span class="p">,</span> <span class="p">[</span><span class="err">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">localhost</span><span class="err">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="err">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">ubuntu</span><span class="err">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="err">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">jabber</span><span class="p">.</span><span class="n">ndpar</span><span class="p">.</span><span class="n">com</span><span class="err">&amp;</span><span class="n">rdquo</span><span class="p">;]}.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>The second thing we need to do is to configure admin user. Here is mine</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>/opt/ejabberd/ejabberd/etc/ejabberd/ejabberd.cfg </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="c">%%%&amp;lsquo;   ACCESS CONTROL LISTS</span>
</span><span class='line'><span class="p">{</span><span class="n">acl</span><span class="p">,</span> <span class="n">admin</span><span class="p">,</span> <span class="p">{</span><span class="n">user</span><span class="p">,</span> <span class="err">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">andrey</span><span class="err">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="err">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">jabber</span><span class="p">.</span><span class="n">ndpar</span><span class="p">.</span><span class="n">com</span><span class="err">&amp;</span><span class="n">rdquo</span><span class="p">;}}.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>After these two changes are done, start the server</p>

<pre><code>$ cd /opt/ejabberd/ejabberd/sbin
$ ./ejabberdctl start
</code></pre>

<h2>Registering users</h2>

<p>The first (admin) user has to be registered in command line</p>

<pre><code>$ ./ejabberdctl register andrey jabber.ndpar.com ******
</code></pre>

<p>This user is the same as admin you configured in the previous section. If you go to <a href="http://localhost:5280/admin">localhost:5280/admin</a> in the browser, you should be able to login with the same password you registered the user</p>

<p><img class="center" src="/images/posts/ejabberd-web.png"></p>

<p>Now you are ready to add newly created account to your Jabber client. In Adium, for example, go to <em>File</em> &ndash;> <em>Add Acount</em> &ndash;> <em>Jabber</em> and provide server hostname/IP, JID and password.</p>

<p><img class="center" src="/images/posts/ejabberd-adium-1.png"></p>

<p><img class="center" src="/images/posts/ejabberd-adium-2.png"></p>

<p>To really enjoy IM you need more users on your server. The best part here is that you can create new users just from your Jabber client. You can actually do many things from the client, and you don&rsquo;t need to ssh to the remote server and run command for that. Just go to <em>File</em> &ndash;> <em>your ejabberd account</em>, and chose whatever you need from the menu</p>

<p><img class="center" src="/images/posts/ejabberd-admin-client.png"></p>
]]></content>
  </entry>
  
</feed>
