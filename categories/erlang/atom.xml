<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Erlang | Side Notes]]></title>
  <link href="http://blog.ndpar.com/categories/erlang/atom.xml" rel="self"/>
  <link href="http://blog.ndpar.com/"/>
  <updated>2014-07-07T20:40:15-04:00</updated>
  <id>http://blog.ndpar.com/</id>
  <author>
    <name><![CDATA[Andrey Paramonov]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Erlang Factory Lite 2013]]></title>
    <link href="http://blog.ndpar.com/2013/11/23/efl-toronto-2013/"/>
    <updated>2013-11-23T07:00:00-05:00</updated>
    <id>http://blog.ndpar.com/2013/11/23/efl-toronto-2013</id>
    <content type="html"><![CDATA[<p>For the last four months I’ve been actively involved in organizing EFL in Toronto.
Now when the conference is over I want to take a few minutes to express my appreciation to all the people who made it happen.</p>

<p><img class="center" src="/images/posts/tefl-2013.jpg"></p>

<p>My big “thank you” goes to (in alphabetical order)</p>

<ul>
  <li>Carlo Barrettara, Wioletta Dec, Michael DiBernardo, Monika Jarzyna, Michael Russo, Dann Toliver</li>
  <li>All speakers: Louis-Philippe Gauthier, Fred Hebert, Christopher Meiklejohn, Igor Ostaptchenko, Yurii Rashkovskii, Tom Santero, Garrett Smith</li>
  <li>All attendees</li>
  <li>My family</li>
</ul>

<p>Thank you all! Without you this conference wouldn’t be possible.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Lambda Jam 2013]]></title>
    <link href="http://blog.ndpar.com/2013/07/08/lambdajam-2013/"/>
    <updated>2013-07-08T05:00:00-04:00</updated>
    <id>http://blog.ndpar.com/2013/07/08/lambdajam-2013</id>
    <content type="html"><![CDATA[<p>This is my impressionistic non-canonical irregular Clojuresque-Erlangish notes on <a href="http://lambdajam.com">Lambda Jam</a> conference which took place in Chicago on July 8–10, 2013.
These notes are pretty long, and I don’t split them on purpose.
If you read them all, you should become overwhelmed and overloaded with the information.
Only this way you can feel the same I felt on the last day of the conference :)</p>

<p><img src="http://lambdajam.com/storage/2013/GrandBallroom2_header.jpg.jpeg?__SQUARESPACE_CACHEVERSION=1361043346973"></p>

<!-- more -->

<h2 id="stuart-sierra--data-visibility-and-abstraction">Stuart Sierra — Data, Visibility, and Abstraction</h2>

<ul>
  <li>Video: <a href="http://www.infoq.com/presentations/data-visibility-abstraction">InfoQ</a></li>
</ul>

<h3 id="quotes">Quotes</h3>

<ul>
  <li>QBasic distinguished between subroutines and functions.</li>
  <li>Perl is a QBasic of Linux.</li>
  <li>Perl provided bunch of abstractions that made my life easier.</li>
  <li>Just a few generic data structures can represent pretty much any kind of data.</li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="c1">#!/usr/bin/env perl&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span><span class="k">my</span> <span class="nv">$user</span> <span class="o">=</span>
</span><span class='line'>  <span class="p">{</span> <span class="n">name</span>  <span class="o">=&amp;</span><span class="ow">gt</span><span class="p">;</span> <span class="err">“</span><span class="n">Stuart</span><span class="err">”</span><span class="p">,</span>
</span><span class='line'>    <span class="n">age</span>   <span class="o">=&amp;</span><span class="ow">gt</span><span class="p">;</span> <span class="mi">15</span><span class="p">,</span>
</span><span class='line'>    <span class="n">langs</span> <span class="o">=&amp;</span><span class="ow">gt</span><span class="p">;</span> <span class="p">[</span> <span class="err">“</span><span class="n">BASIC</span><span class="err">”</span><span class="p">,</span>
</span><span class='line'>               <span class="err">“</span><span class="n">C</span><span class="o">++</span><span class="err">”</span><span class="p">,</span>
</span><span class='line'>               <span class="err">“</span><span class="n">Perl</span><span class="err">”</span> <span class="p">]</span> <span class="p">};</span><span class="sr">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span><span class="k">print</span> <span class="nv">$user</span><span class="o">-&amp;</span><span class="ow">gt</span><span class="p">;{</span><span class="err">‘</span><span class="n">langs</span><span class="err">’</span><span class="p">}[</span><span class="mi">2</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
  <li><code>Tie::File</code> — Access the lines of a disk file via a Perl array.</li>
  <li>XSLT is a homoiconic programming language.</li>
  <li>[In XSLT] you can write the entire program as a series of data transformations.</li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/usr/bin/env bash</span>
</span><span class='line'>saxon one.xslt site.xml t1.xml
</span><span class='line'>saxon two.xslt t1.xml t2.xml
</span><span class='line'>saxon three.xslt t2.xml t3.xml
</span><span class='line'>saxon four.xslt t3.xml index.html
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
  <li>Clojure has universal data structures.</li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">def </span><span class="nv">user</span> <span class="p">{</span><span class="ss">:name</span> <span class="err">“</span><span class="nv">Stuart</span><span class="err">”</span>
</span><span class='line'>           <span class="ss">:age</span> <span class="mi">25</span>
</span><span class='line'>           <span class="ss">:langs</span> <span class="p">[</span><span class="err">“</span><span class="nv">Lisp</span><span class="err">”</span>
</span><span class='line'>                   <span class="err">“</span><span class="nv">Ruby</span><span class="err">”</span>
</span><span class='line'>                   <span class="err">“</span><span class="nv">Clojure</span><span class="err">”</span><span class="p">]})</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
  <li>I’m frequently suspicious of libraries that use a lot of macros to create their abstractions because it means I can’t see them, I can’t manipulate them with the tools I already have.</li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="err">‘</span><span class="nv">clojure.inspector</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">clojure.inspector/inspect-tree</span> <span class="nv">user</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><img class="center" src="/images/posts/clojure.inspector.png"></p>

<ul>
  <li>I started to write my programs as a series of data transformations with just one set of side-effects at the very end.</li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">gather-information</span> <span class="p">[</span><span class="nv">state</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">assoc </span><span class="nv">state</span> <span class="ss">:analysis</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">computation</span> <span class="p">(</span><span class="ss">:input</span> <span class="nv">state</span><span class="p">))))</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="kd">defn </span><span class="nv">make-decision</span> <span class="p">[</span><span class="nv">state</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">assoc </span><span class="nv">state</span> <span class="ss">:response</span>
</span><span class='line'>               <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">condition?</span> <span class="p">(</span><span class="ss">:analysis</span> <span class="nv">state</span><span class="p">))</span>
</span><span class='line'>                   <span class="ss">:launch-missile</span>
</span><span class='line'>                   <span class="ss">:erase-hard-drive</span><span class="p">)))</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="kd">defn </span><span class="nv">take-action</span> <span class="p">[</span><span class="nv">state</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">case</span> <span class="p">(</span><span class="ss">:response</span> <span class="nv">state</span><span class="p">)</span>
</span><span class='line'>    <span class="ss">:launch-missile</span> <span class="p">(</span><span class="nf">launch-missile</span><span class="p">)</span>
</span><span class='line'>    <span class="ss">:erase-hard-drive</span> <span class="p">(</span><span class="nf">erase-hard-drive</span><span class="p">)))</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="kd">defn </span><span class="nv">complex-process</span> <span class="p">[</span><span class="nv">initial-state</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">-</span><span class="o">&amp;</span><span class="nv">gt</span><span class="c1">; initial-state</span>
</span><span class='line'>      <span class="nv">gather-information</span>
</span><span class='line'>      <span class="nv">make-decision</span>
</span><span class='line'>      <span class="nv">take-action</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
  <li>I try to pursue abstractions that make programs more visible, make easier to see what the program is doing.</li>
</ul>

<p><blockquote><p>Being abstract is something profoundly different from being vague…</p></p><p><p>The purpose of abstraction is not to be vague, but to create a new semantic level in which one can be absolutely precise.</p><footer><strong>Edsger Dijkstra</strong></footer></blockquote></p>

<h2 id="aditya-siram--simile-free-monad-recipes">Aditya Siram — Simile-Free Monad Recipes</h2>

<ul>
  <li>Slides: <a href="https://github.com/strangeloop/lambdajam2013/blob/master/slides/Siram-SimileFreeMonadRecipes.pdf">GitHub</a></li>
</ul>

<h3 id="non-idiomatic-haskell-monad-tutorial">Non-idiomatic Haskell monad tutorial</h3>

<p>Working with monads is a switching between monadic and non-monadic context.</p>

<h3 id="io">IO</h3>

<ul>
  <li><code>&lt;-</code> operator gets the value from monadic context.</li>
  <li><code>return</code> puts the value into monadic context.</li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="nf">main</span> <span class="ow">::</span> <span class="kt">IO</span> <span class="nb">()</span>
</span><span class='line'><span class="nf">main</span> <span class="ow">=</span> <span class="kr">do</span>
</span><span class='line'>  <span class="n">writeFile</span> <span class="err">“</span><span class="n">test</span><span class="o">.</span><span class="n">txt</span><span class="err">”</span> <span class="err">“</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="err">”</span> <span class="ow">::</span> <span class="kt">IO</span> <span class="nb">()</span>
</span><span class='line'>  <span class="n">x</span> <span class="ow">::</span> <span class="kt">String</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">-</span> <span class="n">readFile</span> <span class="err">“</span><span class="n">test</span><span class="o">.</span><span class="n">txt</span><span class="err">”</span> <span class="ow">::</span> <span class="kt">IO</span> <span class="kt">String</span>
</span><span class='line'>  <span class="kr">let</span> <span class="n">upCased</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">=</span> <span class="n">map</span> <span class="n">toUpper</span> <span class="n">x</span>
</span><span class='line'>  <span class="n">y</span> <span class="ow">::</span> <span class="kt">String</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">-</span> <span class="n">return</span> <span class="n">upCased</span> <span class="ow">::</span> <span class="kt">IO</span> <span class="kt">String</span>
</span><span class='line'>  <span class="n">print</span> <span class="n">y</span> <span class="ow">::</span> <span class="kt">IO</span> <span class="nb">()</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3 id="reader">Reader</h3>

<ul>
  <li>Reader = Read-only State + Result</li>
  <li><code>runReader</code> :: Reader Monad -&gt; Read-Only State -&gt; Result</li>
  <li><code>ask</code> extracts the state from the monad for inspection.</li>
</ul>

<h3 id="writer">Writer</h3>

<ul>
  <li>Writer = Append-Only State + Result</li>
  <li><code>runWriter</code> :: Writer Monad -&gt; (Result, Accumulated State)</li>
  <li>State is accumulated using <code>tell</code>.</li>
</ul>

<h3 id="state">State</h3>

<ul>
  <li>State Monad = Mutable State + Result</li>
  <li><code>get</code>, <code>put</code> do what they sound like.</li>
  <li><code>runState</code> :: State Monad -&gt; Initial State -&gt; (Result, New State)</li>
  <li>Initial State is required.</li>
</ul>

<h2 id="dean-wampler--copious-data-the-killer-app-for-fp">Dean Wampler — Copious Data, the “Killer App” for FP</h2>

<ul>
  <li>Slides: <a href="https://github.com/strangeloop/lambdajam2013/blob/master/slides/Wampler-CopiousDataTheKillerAppForFP.pdf">GitHub</a></li>
  <li>Video: <a href="http://www.infoq.com/presentations/big-data-functional-programming">InfoQ</a></li>
</ul>

<h3 id="quotes-1">Quotes</h3>

<ul>
  <li>It’s hard to implement many algorithms in MapReduce.</li>
  <li>MapReduce is very course-grained.</li>
  <li>For Hadoop in particularly, the Java API is hard to use.</li>
  <li>Hadoop is the EJBs of our time</li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">import</span> <span class="nn">org.apache.hadoop.io.</span><span class="o">&lt;</span><span class="n">em</span><span class="o">&gt;;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">org.apache.hadoop.mapred.</span><span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="kd">class</span> <span class="nc">WCMapper</span> <span class="kd">extends</span> <span class="n">MapReduceBase</span>
</span><span class='line'>    <span class="kd">implements</span> <span class="n">Mapper</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">LongWritable</span><span class="o">,</span> <span class="n">Text</span><span class="o">,</span> <span class="n">Text</span><span class="o">,</span> <span class="n">IntWritable</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">static</span> <span class="kd">final</span> <span class="n">IntWritable</span> <span class="n">one</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntWritable</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span><span class='line'><span class="kd">static</span> <span class="kd">final</span> <span class="n">Text</span> <span class="n">word</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Text</span><span class="o">();</span> <span class="c1">// Value will be set in a non-thread-safe way!</span>
</span><span class='line'>
</span><span class='line'><span class="nd">@Override</span>
</span><span class='line'><span class="kd">public</span> <span class="kt">void</span> <span class="nf">map</span><span class="o">(</span><span class="n">LongWritable</span> <span class="n">key</span><span class="o">,</span> <span class="n">Text</span> <span class="n">valueDocContents</span><span class="o">,</span>
</span><span class='line'>        <span class="n">OutputCollector</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Text</span><span class="o">,</span> <span class="n">IntWritable</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">output</span><span class="o">,</span> <span class="n">Reporter</span> <span class="n">reporter</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">String</span><span class="o">[]</span> <span class="n">tokens</span> <span class="o">=</span> <span class="n">valueDocContents</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">split</span><span class="o">(</span><span class="s">&quot;\\s+&quot;</span><span class="o">);</span>
</span><span class='line'>    <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="nl">wordString:</span> <span class="n">tokens</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="o">(</span><span class="n">wordString</span><span class="o">.</span><span class="na">length</span> <span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">word</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">wordString</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">());</span>
</span><span class='line'>            <span class="n">output</span><span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">word</span><span class="o">,</span> <span class="n">one</span><span class="o">);</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span> <span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="kd">class</span> <span class="nc">Reduce</span> <span class="kd">extends</span> <span class="n">MapReduceBase</span>
</span><span class='line'>    <span class="kd">implements</span> <span class="n">Reducer</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Text</span><span class="o">,</span> <span class="n">IntWritable</span><span class="o">,</span> <span class="n">Text</span><span class="o">,</span> <span class="n">IntWritable</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="kd">public</span> <span class="kt">void</span> <span class="n">reduce</span><span class="o">(</span><span class="n">Text</span> <span class="n">keyWord</span><span class="o">,</span> <span class="n">Iterator</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">IntWritable</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">valuesCounts</span><span class="o">,</span>
</span><span class='line'>        <span class="n">OutputCollector</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Text</span><span class="o">,</span> <span class="n">IntWritable</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">output</span><span class="o">,</span> <span class="n">Reporter</span> <span class="n">reporter</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">totalCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</span><span class='line'>    <span class="k">while</span> <span class="o">(</span><span class="n">valuesCounts</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">totalCount</span> <span class="o">+=</span> <span class="n">valuesCounts</span><span class="o">.</span><span class="na">next</span><span class="o">().</span><span class="na">get</span><span class="o">();</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="n">output</span><span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">keyWord</span><span class="o">,</span> <span class="k">new</span> <span class="n">IntWritable</span><span class="o">(</span><span class="n">totalCount</span><span class="o">));</span>
</span><span class='line'><span class="o">}</span> <span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</code></pre>

<ul>
  <li>Use Cascalog</li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">lowercase</span> <span class="p">[</span><span class="nv">w</span><span class="p">]</span> <span class="p">(</span><span class="nf">.toLowerCase</span> <span class="nv">w</span><span class="p">))</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="nf">?</span><span class="o">&amp;</span><span class="nv">lt</span><span class="c1">;- (stdout) [?word ?count]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">sentence</span> <span class="nv">?s</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">split</span> <span class="nv">?s</span> <span class="err">:</span><span class="o">&amp;</span><span class="nv">gt</span><span class="c1">; ?word1)</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">lowercase</span> <span class="nv">?word1</span> <span class="err">:</span><span class="o">&amp;</span><span class="nv">gt</span><span class="c1">; ?word)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">c/count</span> <span class="nv">?count</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
  <li>Use Spark</li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">object</span> <span class="nc">WordCountSpark</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">def</span> <span class="n">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">file</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">textFile</span><span class="o">(</span><span class="n">args</span><span class="o">(</span><span class="mi">0</span><span class="o">))</span>
</span><span class='line'>        <span class="k">val</span> <span class="n">counts</span> <span class="k">=</span> <span class="n">file</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">line</span> <span class="o">=&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="err">“</span><span class="o">\</span><span class="n">W</span><span class="o">+</span><span class="err">”</span><span class="o">))</span>
</span><span class='line'>                         <span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">word</span> <span class="o">=&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="o">(</span><span class="n">word</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span>
</span><span class='line'>                         <span class="o">.</span><span class="n">reduceByKey</span><span class="o">(</span><span class="k">_</span> <span class="o">+</span> <span class="k">_</span><span class="o">)</span>
</span><span class='line'>        <span class="n">counts</span><span class="o">.</span><span class="n">saveAsTextFile</span><span class="o">(</span><span class="n">args</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
  <li>Data problems are fundamentally Mathematics!</li>
  <li>Data will drive widespread FP adoption.</li>
</ul>

<h3 id="resources">Resources</h3>

<ul>
  <li><a href="http://www.cascading.org">Cascading</a> — an application framework for Java developers to simply develop Data Analytics applications on Hadoop.</li>
  <li>Nathan Marz — Introducing Cascalog: a Clojure-based query language for Hadoop. [<a href="http://nathanmarz.com/blog/introducing-cascalog-a-clojure-based-query-language-for-hado.html">blog</a>]</li>
  <li><a href="http://storm-project.net">Storm</a> — free and open source distributed realtime computation system.</li>
  <li><a href="http://spark-project.org">Spark</a> — an open source cluster computing system that aims to make data analytics fast.</li>
  <li>Evan Miller — The Mathematical Hacker. [<a href="http://www.evanmiller.org/mathematical-hacker.html">blog</a>]</li>
</ul>

<h2 id="jam">Jam</h2>

<p>A jam is similar to a code retreat, only you work in groups instead of pairs. It starts with a problem description. Then you form a group and work on the problem for three hours. In the end you share your experience with the audience.</p>

<p>The problem of the first jam was Peter Norvig’s <a href="http://norvig.com/spell-correct.html">Spelling Corrector</a>. I was wandering the room looking for an Erlang group to join when I bumped into this bunch of wonderful people: <a href="https://twitter.com/Bruce_Adams">Bruce Adams</a>, <a href="https://twitter.com/joeerl">Joe Armstrong</a>, <a href="https://twitter.com/gar1t">Garrett Smith</a>, <a href="https://twitter.com/bryan_hunter">Bryan Hunter</a>, and <a href="https://twitter.com/karl_grz">Karl Grzeszczak</a>.</p>

<p><img class="center" src="https://pbs.twimg.com/media/BOrdEK6CYAA2zlb.jpg"></p>

<p>Soon the jam transformed into an Erlang master class from Joe Armstrong. We were watching Joe’s work flow, his way of thinking, learning his tips and tricks, listening to his brilliant comments about Erlang and Haskell.</p>

<p><img class="center" src="https://pbs.twimg.com/media/BOrk-wfCEAE3kKr.jpg"></p>

<p>At some point I remarked how elegant was the function Joe Armstrong just implemented, on which he replied: <strong><em>There is not much intelligence here. It’s all about practice.</em></strong></p>

<p><blockquote><p>Today I watched @joeerl implementing a parallel spell checker in Erlang. That was worth the price of admission alone. Thank you! #LambdaJam</p><footer><strong>@karl_grz</strong> <cite><a href='https://twitter.com/karl_grz/statuses/354386650291380224'>twitter.com/karl_grz/statuses/&hellip;</a></cite></footer></blockquote></p>

<h3 id="resources-1">Resources</h3>

<ul>
  <li><a href="https://github.com/ericnormand/spelling-jam/blob/master/code/erlang/spell.erl">Source code</a></li>
</ul>

<h2 id="joe-armstrong--keynote">Joe Armstrong — Keynote</h2>

<h3 id="systems-that-run-forever-self-heal-and-scale">Systems That Run Forever Self-Heal and Scale</h3>

<ul>
  <li>Slides: <a href="https://github.com/strangeloop/lambdajam2013/blob/master/slides/Armstrong-SystemsThatRunForever.pdf">GitHub</a></li>
  <li>Video: <a href="http://www.infoq.com/presentations/self-heal-scalable-system">InfoQ</a></li>
</ul>

<h3 id="quotes-2">Quotes</h3>

<ul>
  <li>I’m not interested in programming languages. I’m interested in solving problems.</li>
  <li>Primary goal Erlang was designed for is the fault-talerant computation.</li>
  <li>I think it’s a bad idea to design your system for 10 people and then scale it up for 10,000. It’s better to design it for 10M and scale it down.</li>
  <li>The difficult part of making reliable system is to make multiple machines work independently in parallel.</li>
</ul>

<p>Why distributed programming is hard</p>

<ol>
  <li>Difficulty in identifying and dealing with failures.</li>
  <li>Achieving consistency in data across processes.</li>
  <li>Heterogeneous nature of the components involved in the system.</li>
  <li>Testing a distributed system is quite difficult.</li>
  <li>The technologies involved in distributed systems are not easy to understand.</li>
</ol>

<p><em>Chord</em> algorithm: distributing data across several machines</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>S1 <span class="nv">IP</span> <span class="o">=</span> 235.23.34.12
</span><span class='line'>S2 <span class="nv">IP</span> <span class="o">=</span> 223.23.141.53
</span><span class='line'>S3 <span class="nv">IP</span> <span class="o">=</span> 122.67.12.23&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;md5<span class="o">(</span>ip<span class="o">(</span>s1<span class="o">))</span> <span class="o">=</span> C82D4DB065065DBDCDADFBC5A727208E
</span><span class='line'>md5<span class="o">(</span>ip<span class="o">(</span>s2<span class="o">))</span> <span class="o">=</span> 099340C20A42E004716233AB216761C3
</span><span class='line'>md5<span class="o">(</span>ip<span class="o">(</span>s3<span class="o">))</span> <span class="o">=</span> A0E607462A563C4D8CCDB8194E3DEC8B&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Sorted:
</span><span class='line'><span class="nv">099340C20A42E004716233AB216761C3</span> <span class="o">=</span>&amp;gt; s2
</span><span class='line'><span class="nv">A0E607462A563C4D8CCDB8194E3DEC8B</span> <span class="o">=</span>&amp;gt; s3
</span><span class='line'><span class="nv">C82D4DB065065DBDCDADFBC5A727208E</span> <span class="o">=</span>&amp;gt; s1&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;lookup <span class="nv">Key</span> <span class="o">=</span> “mail-23412”
</span><span class='line'>md5<span class="o">(</span>“mail-23412”<span class="o">)</span> <span class="o">=</span>&amp;gt; B91AF709D7C1E6988FCEE7ADF7094A26&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;So the Value is on machine s3 <span class="o">(</span>first machine with Md5 lower than md5 of key<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Replica:
</span><span class='line'>md5<span class="o">(</span>md5<span class="o">(</span>“mail-23412”<span class="o">))</span> <span class="o">=</span>&amp;gt; D604E7A54DC18FD7AC70D12468C34B63&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;So the replica is on machine s1
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
  <li>What if master dies? <em>Paxos</em> — distributed leadership election algorithm. Very complicated algorithm that only few people understand.</li>
  <li>The leadership election is solved in OTP (mnesia, gen_leader) and Riak.</li>
  <li>You don’t need libraries to write web server. Any fool can write them. But distributed data storage is difficult.</li>
</ul>

<p>Six rules for building HA systems</p>

<ol>
  <li>Isolation</li>
  <li>Concurrency</li>
  <li>Failure detection</li>
  <li>Fault identification</li>
  <li>Live code upgrade</li>
  <li>Stable storage</li>
</ol>

<ul>
  <li>With stable storage you don’t need backups. You need snapshots, because you override the data, but you don’t need backups.</li>
  <li>Threads are evil because they share resources.</li>
  <li>We already solved the problem with parallel computing (in Erlang). <em>We are working on detecting bottlenecks now.</em></li>
</ul>

<h3 id="resources-2">Resources</h3>

<ul>
  <li>Ericsson <a href="http://www.ericsson.com/ourportfolio/products/sgsn-mme">SGSN-MME</a>.</li>
  <li>Rajith Attapattu — 5 reasons why Distributed Systems are hard to program. [<a href="http://rajith.2rlabs.com/2008/07/23/5-reasons-why-distributed-systems-are-hard-to-develop/">blog</a>]</li>
  <li><a href="http://en.wikipedia.org/wiki/Chord_(peer-to-peer)">Chord</a> algorithm.</li>
  <li><a href="http://en.wikipedia.org/wiki/Paxos_(computer_science)">Paxos</a> algorithm.</li>
  <li>Leslie Lamport — Paxos Made Simple. [<a href="http://www.cs.utexas.edu/users/lorenzo/corsi/cs380d/past/03F/notes/paxos-simple.pdf">pdf</a>]</li>
  <li>Thomas Arts, Koen Claessen, Hans Svensson — Semi-formal development of a fault-tolerant leader election protocol in Erlang. [<a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.101.3220">article</a>]</li>
  <li><a href="http://concurix.com">Concurix</a> — performance tool for Erlang.</li>
</ul>

<h2 id="erlang-beer-with-joe-armstrong">Erlang beer with Joe Armstrong</h2>

<p><blockquote><p>For those who didn't hear, we're meeting up at The Public House - 400 N State St.</p><footer><strong>@gar1t</strong> <cite><a href='https://twitter.com/gar1t/statuses/354375863971749888'>twitter.com/gar1t/statuses/&hellip;</a></cite></footer></blockquote></p>

<p>This was the best part of the first day :)</p>

<h2 id="john-daily--distributed-programming-with-riak-core-and-pipe">John Daily — Distributed Programming with Riak Core and Pipe</h2>

<ul>
  <li>Slides: <a href="https://github.com/strangeloop/lambdajam2013/blob/master/slides/Daily-RiakCorePipe.pdf">GitHub</a></li>
</ul>

<p>Distributed programming is hard (clocks, latency, lost messages, servers break). Use Riak.</p>

<h3 id="resources-3">Resources</h3>

<ul>
  <li>Sources: Riak <a href="https://github.com/basho/riak_core">core</a> and <a href="https://github.com/basho/riak_pipe">pipe</a>.</li>
  <li>Eric Redmond — A Little Riak <a href="https://github.com/coderoshi/little_riak_book/tree/master/rendered/">Book</a>.</li>
</ul>

<h2 id="tracy-harms--semantics-clarity-and-notation-the-benefits-of-expressions-over-statements">Tracy Harms — Semantics, clarity, and notation: the benefits of expressions over statements</h2>

<p><blockquote><p>@kaleidic’s “Benefits of Expressions Over Statements” is gold. Brain is barely keeping up.</p><footer><strong>@bryan_hunter</strong> <cite><a href='https://twitter.com/bryan_hunter/statuses/354619102792396803'>twitter.com/bryan_hunter/&hellip;</a></cite></footer></blockquote></p>

<ul>
  <li>Expressions condense meaning in space, and eliminate time.</li>
  <li>Understanding occurs only when meaning is selected and simplified enough for a mind to think about it.</li>
</ul>

<p><blockquote><p>This is the example @kaleidic is showing now</p><footer><strong>@gazoombo</strong> <cite><a href='https://twitter.com/gazoombo/statuses/354622989599383552'>twitter.com/gazoombo/statuses/&hellip;</a></cite></footer></blockquote></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>allmasks=: 2 #:@i.@^ #
</span><span class='line'>firstend=: 1 0 i.&amp;1@E.”1 ]
</span><span class='line'>laststart=: 0 1 {:@I.@E.”1 ]
</span><span class='line'>noncont=: &lt;@#~ (#~ firstend &lt; laststart)@allmasks&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>noncont 1+i.4
</span><span class='line'>┌───┬───┬───┬─────┬─────┐
</span><span class='line'>│2 4│1 4│1 3│1 3 4│1 2 4│
</span><span class='line'>└───┴───┴───┴─────┴─────┘&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>noncont ‘aeiou’
</span><span class='line'>┌──┬──┬──┬───┬───┬──┬──┬───┬──┬───┬───┬────┬───┬───┬────┬────┐
</span><span class='line'>│iu│eu│eo│eou│eiu│au│ao│aou│ai│aiu│aio│aiou│aeu│aeo│aeou│aeiu│
</span><span class='line'>└──┴──┴──┴───┴───┴──┴──┴───┴──┴───┴───┴────┴───┴───┴────┴────┘&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>#noncont i.10
</span><span class='line'>968</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3 id="resources-4">Resources</h3>

<ul>
  <li>P. J. Landin — The Next 700 Programming Languages. [<a href="http://www.cs.cmu.edu/~crary/819-f09/Landin66.pdf">pdf</a>]</li>
  <li>Tracy Harms — J: A Programming Language. [<a href="http://kaleidic.com/talks/ELC2013-1-1.pdf">pdf</a>]</li>
</ul>

<h2 id="chris-ford--functional-composition">Chris Ford — Functional composition</h2>

<ul>
  <li>Video: <a href="http://www.infoq.com/presentations/music-functional-language">InfoQ</a></li>
  <li>Demo source code: <a href="https://github.com/ctford/functional-composition/tree/LambdaJam-2013">GitHub</a></li>
</ul>

<h3 id="quotes-3">Quotes</h3>

<ul>
  <li>Western music notation is a DSL designed to be executed on a pecular kind of FSM called the musician.</li>
  <li>Sound error correction happening in the brain.</li>
  <li>Given the audience, let’s try <em>F sharp blues</em>.</li>
  <li>A canon is defined as a series of notes that are accompanied by a functional transformation of themselves.</li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">canon</span> <span class="p">[</span><span class="nv">f</span> <span class="nv">notes</span><span class="p">]</span> <span class="p">(</span><span class="nb">concat </span><span class="nv">notes</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">notes</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
  <li>These are all pure functions, so we can compose them together. And that’s what composers did long before the lambda calculus was invented.</li>
</ul>

<h2 id="clinton-dreisbach--functional-web-development-with-clojure">Clinton Dreisbach — Functional Web Development with Clojure</h2>

<p>The Clojure way of web development: lots of loosely coupled libraries.</p>

<h3 id="ring">Ring</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defproject </span><span class="nv">request-echo</span> <span class="err">“</span><span class="mf">0.1</span><span class="nv">.0-SNAPSHOT</span><span class="err">”</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="ss">:dependencies</span> <span class="p">[[</span><span class="nv">org.clojure/clojure</span> <span class="err">“</span><span class="mf">1.5</span><span class="nv">.1</span><span class="err">”</span><span class="p">]</span>
</span><span class='line'>                 <span class="p">[</span><span class="nv">ring</span> <span class="err">“</span><span class="mf">1.1</span><span class="nv">.8</span><span class="err">”</span><span class="p">]]</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="ss">:plugins</span> <span class="p">[[</span><span class="nv">lein-ring</span> <span class="err">“</span><span class="mf">0.8</span><span class="nv">.3</span><span class="err">”</span><span class="p">]]</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="ss">:ring</span> <span class="p">{</span><span class="ss">:handler</span> <span class="nv">request-echo/handler</span>
</span><span class='line'>         <span class="ss">:port</span> <span class="mi">3001</span><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<pre><code>lein ring server
</code></pre>

<p><img class="center" src="/images/posts/ring.png"></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">ns </span><span class="nv">request-echo</span>
</span><span class='line'>  <span class="p">(</span><span class="ss">:require</span> <span class="p">[</span><span class="nv">clojure.pprint</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv">pprint</span><span class="p">]]))</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="kd">defn </span><span class="nv">handler</span> <span class="p">[</span><span class="nv">request</span><span class="p">]</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="ss">:body</span> <span class="p">(</span><span class="nb">str </span><span class="err">“</span><span class="o">&amp;</span><span class="nv">lt</span><span class="c1">;h1&amp;gt;Request Echo&amp;lt;/h1&amp;gt;&amp;lt;pre&amp;gt;”</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">with-out-str </span><span class="p">(</span><span class="nf">pprint</span> <span class="nv">request</span><span class="p">))</span>
</span><span class='line'>              <span class="err">“</span><span class="o">&amp;</span><span class="nv">lt</span><span class="c1">;/pre&amp;gt;”)})</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3 id="compojure">Compojure</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="err">‘</span><span class="p">[</span><span class="nv">compojure.core</span> <span class="ss">:refer</span> <span class="ss">:all</span><span class="p">])</span>
</span><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="err">‘</span><span class="p">[</span><span class="nv">compojure.route</span> <span class="ss">:as</span> <span class="nv">route</span><span class="p">])</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="nf">routes</span>
</span><span class='line'>  <span class="c1">;verb  route   parameters        handler</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span>   <span class="err">“</span><span class="nv">/</span><span class="err">”</span>     <span class="p">[]</span>                <span class="p">(</span><span class="nf">index-page</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span>   <span class="err">“</span><span class="nv">/debts/</span><span class="ss">:person</span><span class="err">”</span> <span class="p">[</span><span class="nv">person</span><span class="p">]</span> <span class="p">(</span><span class="nf">person-page</span> <span class="nv">person</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span>   <span class="err">“</span><span class="nv">/add-debt</span><span class="err">”</span> <span class="p">[]</span>            <span class="p">(</span><span class="nf">add-debt-page</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">POST</span>  <span class="err">“</span><span class="nv">/add-debt</span><span class="err">”</span> <span class="p">[</span><span class="nv">from</span> <span class="nv">to</span> <span class="nv">amount</span><span class="p">]</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">add-debt-post</span> <span class="p">{</span><span class="ss">:from</span> <span class="nv">from</span>, <span class="ss">:to</span> <span class="nv">to</span>, <span class="ss">:amount</span> <span class="nv">amount</span><span class="p">}))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">route/resources</span> <span class="err">“</span><span class="nv">/</span><span class="err">”</span><span class="p">)</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">route/not-found</span> <span class="err">“</span><span class="nv">Page</span> <span class="nb">not </span><span class="nv">found</span><span class="err">”</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3 id="hiccup">Hiccup</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="err">‘</span><span class="p">[</span><span class="nv">hiccup.core</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv">html</span><span class="p">]])</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="nf">html</span> <span class="p">[</span><span class="ss">:a.btn</span>         <span class="c1">; element + class or id</span>
</span><span class='line'>       <span class="p">{</span><span class="ss">:href</span> <span class="err">“</span><span class="nv">/go</span><span class="err">”</span><span class="p">}</span>  <span class="c1">; map for attributes</span>
</span><span class='line'>       <span class="err">“</span><span class="nv">Click</span> <span class="nv">here</span><span class="err">”</span><span class="p">])</span> <span class="c1">; Content</span>
</span><span class='line'><span class="c1">;;=&amp;gt; “&lt;a class=&quot;btn&quot; href=&quot;http://blog.ndpar.com/go&quot;&gt;Click here&lt;/a&gt;”</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3 id="cheshire">Cheshire</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="err">‘</span><span class="p">[</span><span class="nv">cheshire.core</span> <span class="ss">:as</span> <span class="nv">json</span><span class="p">])</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">debts</span> <span class="p">(</span><span class="ss">:debts</span> <span class="err">@</span><span class="nv">db</span><span class="p">)</span>
</span><span class='line'>      <span class="nv">balances</span> <span class="p">(</span><span class="nf">debts/balances</span> <span class="nv">debts</span><span class="p">)]</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="ss">:body</span> <span class="p">(</span><span class="nf">json/generate-string</span>
</span><span class='line'>          <span class="p">{</span><span class="ss">:debts</span> <span class="nv">debts</span>
</span><span class='line'>           <span class="ss">:balances</span> <span class="nv">balances</span><span class="p">})})</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="nf">routes</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">POST</span> <span class="err">“</span><span class="nv">/add-debt.json</span><span class="err">”</span> <span class="p">{</span><span class="nv">body</span> <span class="ss">:body</span><span class="p">}</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">views/add-debt-json</span> <span class="nv">db</span> <span class="p">(</span><span class="nb">slurp </span><span class="nv">body</span><span class="p">))))</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="kd">defn </span><span class="nv">add-debt-json</span> <span class="p">[</span><span class="nv">db</span> <span class="nv">body</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">json/parse-string</span> <span class="nv">body</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3 id="garden">Garden</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="err">‘</span><span class="p">[</span><span class="nv">garden.units</span> <span class="ss">:as</span> <span class="nv">u</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv">px</span> <span class="nv">pt</span><span class="p">]])</span>
</span><span class='line'><span class="p">(</span><span class="nf">require</span> <span class="err">‘</span><span class="p">[</span><span class="nv">garden.core</span> <span class="ss">:refer</span> <span class="p">[</span><span class="nv">css</span><span class="p">]])</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="k">def </span><span class="nv">default-color</span> <span class="err">“</span><span class="o">#</span><span class="nv">EFE</span><span class="err">”</span><span class="p">)</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">[[</span><span class="ss">:body</span>
</span><span class='line'>  <span class="p">{</span><span class="ss">:background-color</span> <span class="nv">default-color</span><span class="p">}]</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">[</span><span class="ss">:.btn-primary&lt;/p&gt;</span>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">[</span><span class="err">:</span><span class="o">&amp;</span><span class="nv">amp</span><span class="c1">;:hover</span>
</span><span class='line'>   <span class="p">{</span><span class="ss">:border-color</span> <span class="err">“</span><span class="nv">black</span><span class="err">”</span><span class="p">}]]]</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="nf">routes</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">GET</span> <span class="err">“</span><span class="nv">/&lt;em&gt;.css</span><span class="err">”</span> <span class="p">{</span> <span class="p">{</span><span class="nb">path </span><span class="ss">:&lt;/em&gt;</span><span class="p">}</span> <span class="ss">:route-params</span><span class="p">}</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">views/css-page-memoized</span> <span class="nv">path</span><span class="p">)))</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="kd">defn </span><span class="nv">css-page</span> <span class="p">[</span><span class="nv">path</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">when-let </span><span class="p">[</span><span class="nv">garden-url</span> <span class="p">(</span><span class="nf">io/resource</span> <span class="p">(</span><span class="nb">str </span><span class="err">“</span><span class="nv">public/</span><span class="err">”</span> <span class="nb">path </span><span class="err">“</span><span class="nv">.garden</span><span class="err">”</span><span class="p">))]</span>
</span><span class='line'>    <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">garden-data</span> <span class="p">(</span><span class="nb">load-file </span><span class="p">(</span><span class="nf">.getPath</span> <span class="nv">garden-url</span><span class="p">))]</span>
</span><span class='line'>      <span class="p">{</span><span class="ss">:status</span> <span class="mi">200</span>
</span><span class='line'>       <span class="ss">:headers</span> <span class="p">{</span><span class="err">“</span><span class="nv">Content-Type</span><span class="err">”</span> <span class="err">“</span><span class="nv">text/css</span><span class="err">”</span><span class="p">}</span>
</span><span class='line'>       <span class="ss">:body</span> <span class="p">(</span><span class="nf">css</span> <span class="nv">garden-data</span><span class="p">)})))</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="k">def </span><span class="nv">css-page-memoized</span> <span class="p">(</span><span class="nf">memoize</span> <span class="nv">css-page</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3 id="resources-5">Resources</h3>

<ul>
  <li><a href="https://github.com/noir-clojure/lib-noir">lib-noir</a> — a set of utilities and helpers for building ring apps.</li>
  <li><a href="http://www.luminusweb.net/">Luminus</a> — another Clojure web framework.</li>
  <li><a href="https://github.com/clojure/clojurescript">ClojureScript</a> — Clojure to JS compiler.</li>
  <li><a href="http://pedestal.io">Pedestal</a> — another framework.</li>
  <li><a href="http://clojure-liberator.github.io/liberator/">Liberator</a> — WebMachine in Clojure.</li>
</ul>

<h2 id="gerald-sussman--keynote">Gerald Sussman — Keynote</h2>

<h3 id="programming-for-the-expression-of-ideas">Programming for the Expression of Ideas</h3>

<ul>
  <li>Slides: <a href="https://github.com/strangeloop/lambdajam2013/blob/master/slides/Sussman-ExpressionOfIdeas.pdf">GitHub</a></li>
  <li>Video: <a href="http://www.infoq.com/presentations/Expression-of-Ideas">InfoQ</a></li>
</ul>

<p><blockquote><p>Gerald Sussman on stage and Joe Armstrong in the front row nodding along. #LambdaJam is a special place.</p><footer><strong>@bryan_hunter</strong> <cite><a href='https://twitter.com/bryan_hunter/statuses/354717953125650432'>twitter.com/bryan_hunter/&hellip;</a></cite></footer></blockquote></p>

<p><img class="center" src="http://d3j5vwomefv46c.cloudfront.net/photos/large/789035195.jpg"></p>

<p>Lagrange’s equations of motion in Leibniz notation (with type violation)</p>

<script type="math/tex; mode=display">
\frac{\mathrm d}{\mathrm d t} \left(\frac{\partial L}{\partial \dot{q}^i}\right) - \frac{\partial L}{\partial q^i} = 0
</script>

<p>Expanded form (correct but ugly)</p>

<script type="math/tex; mode=display">% &lt;![CDATA[

\frac{\mathrm d}{\mathrm d t} \left(\left.\frac{\partial L(t,q,\dot{q})}{\partial \dot{q}}\right|_{\begin{aligned}q &= w(t)\\ \dot{q} &= \frac{\mathrm d w(t)}{\mathrm d t}\end{aligned}}\right) - \left.\frac{\partial L(t,q,\dot{q})}{\partial q}\right|_{\begin{aligned}q &= w(t)\\ \dot{q} &= \frac{\mathrm d w(t)}{\mathrm d t}\end{aligned}} = 0
 %]]&gt;</script>

<p>Functional form (correct and beautiful)</p>

<script type="math/tex; mode=display">
D((\partial_2 L) \circ (\Gamma[w])) - (\partial_1 L) \circ (\Gamma[w]) = 0
</script>

<p>where</p>

<script type="math/tex; mode=display">
(Df)(t) = \left.\frac{\mathrm d}{\mathrm d x} f(x)\right|_{x=t}  \qquad  \Gamma[w](t) = (t, w(t), Dw(t))
</script>

<p>As Scheme code</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">((</span><span class="nf">Lagrange-equations</span> <span class="nv">Lagrangian</span><span class="p">)</span> <span class="nv">w</span><span class="p">)</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">D</span> <span class="p">(</span><span class="nf">compose</span> <span class="p">((</span><span class="nf">partial</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">Lagrangian</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">(</span><span class="nf">Gamma</span> <span class="nv">w</span><span class="p">)))</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">compose</span> <span class="p">((</span><span class="nf">partial</span> <span class="mi">1</span><span class="p">)</span> <span class="nv">Lagrangian</span><span class="p">)</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">Gamma</span> <span class="nv">w</span><span class="p">))))</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="k">define </span><span class="p">((</span><span class="nf">Gamma</span> <span class="nv">w</span><span class="p">)</span> <span class="nv">t</span><span class="p">)</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">up</span> <span class="nv">t</span> <span class="p">(</span><span class="nf">w</span> <span class="nv">t</span><span class="p">)</span> <span class="p">((</span><span class="nf">D</span> <span class="nv">w</span><span class="p">)</span> <span class="nv">t</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>We can even generate LaTeX from the Scheme code.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="p">(</span><span class="nf">show-expression</span>
</span><span class='line'>  <span class="p">(((</span><span class="nf">Lagrange-equations</span> <span class="p">(</span><span class="nf">L-harmonic</span> <span class="err">‘</span><span class="nv">m</span> <span class="err">‘</span><span class="nv">k</span><span class="p">))</span>
</span><span class='line'>    <span class="nv">proposed-solution</span><span class="p">)</span>
</span><span class='line'>   <span class="err">‘</span><span class="nv">t</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>The moral: originally, Lagrange’s equations had missing parameters and a type error. Programming them forced an elegant and <em>effective</em> statement.</p>

<p><img class="center" src="https://pbs.twimg.com/media/BOxIoM5CEAIpW0o.jpg"></p>

<h3 id="quotes-4">Quotes</h3>

<ul>
  <li>Computer revolution changed the way we think.</li>
  <li>The way we teach students is not the same way we do it ourselves.</li>
  <li>I’ve been doing it all my life. My real goal is to transform things that are hard to understand to the things that are easy to understand. Programming was one of the tools of doing that.</li>
  <li>Students have to learn simultaneously the language and the culture, as well as the content.</li>
  <li>I like to tell students what is going on.</li>
  <li>Idioms make reading hard.</li>
  <li>Leibniz notation for the derivatives happens to be a disaster.</li>
  <li>Let’s get to the General Relativity… I’ll be mercifully short.</li>
  <li>The point is, it makes it comprehensible what was badly expressed in the traditional form.</li>
  <li>I have no problem of enslaving electronic apparatus.</li>
</ul>

<h3 id="resources-6">Resources</h3>

<ul>
  <li>Michael Spivak — Calculus. [<a href="http://ia801606.us.archive.org/22/items/Calculus_643/Spivak-Calculus.pdf">pdf</a>]</li>
  <li>Gerald Jay Sussman, Jack Wisdom — Functional Differential Geometry. [<a href="http://mitpress.mit.edu/books/functional-differential-geometry">MIT</a>]</li>
  <li>Marvin Minsky — Why programming is a good medium for expressing poorly understood and sloppily-formulated ideas. [<a href="http://web.media.mit.edu/~minsky/papers/Why%20programming%20is--.html">html</a>]</li>
</ul>

<h2 id="erlang-cocktail">Erlang cocktail</h2>

<p>with
<a href="https://twitter.com/bryan_hunter">Bryan Hunter</a>,
<a href="https://twitter.com/joeerl">Joe Armstrong</a>, and
<a href="https://twitter.com/kscaldef">Kevin Scaldeferri</a></p>

<p><img class="center" src="https://pbs.twimg.com/media/BOx-YSyCQAAA_TQ.jpg"></p>

<p>Wonderful ending of the second day.</p>

<h2 id="dave-thomas--living-in-big-data-with-vector-functional-programming">Dave Thomas — Living in Big Data with Vector Functional Programming</h2>

<ul>
  <li>Slides: <a href="https://github.com/strangeloop/lambdajam2013/blob/master/slides/Thomas-LivingInBigDataWithVectorFunctionalProgramming.pdf">GitHub</a></li>
</ul>

<p><blockquote><p>This is the first time I’ve been in the audience of a talk on vector languages.</p><footer><strong>@kaleidic</strong> <cite><a href='https://twitter.com/kaleidic/statuses/354961117816176642'>twitter.com/kaleidic/statuses/&hellip;</a></cite></footer></blockquote></p>

<ul>
  <li>Extreme cases — that’s what is interesting.</li>
  <li>I don’t do Big Data, I don’t have a petabyte in my pocket.</li>
  <li>I’m an industrial language pimp.</li>
  <li>I’ve got 3 characters on the screen and I have no idea what they’re doing.</li>
  <li>What slows languages down is scalars and non-scalars, boxing and unboxing.</li>
  <li>How to learn an array language? Slowly.</li>
</ul>

<p><img class="center" src="https://pbs.twimg.com/media/BO0b6S-CMAI2CFd.jpg"></p>

<ul>
  <li>Pairing is a great way to learn new things.</li>
  <li>Most programs, by 2020, will be queries.</li>
  <li>There are five error messages, they are all irritating.</li>
  <li>WTF (what the function?) error message.</li>
  <li>All IDEs are bad. Intellij is the best of worst.</li>
</ul>

<h3 id="resources-7">Resources</h3>

<ul>
  <li>Emily Bache — An introduction to Array Languages. [<a href="http://coding-is-like-cooking.info/2013/09/an-introduction-to-array-languages/">blog</a>]</li>
  <li>Bryan Cantrilla — Conversation with Arthur Whitney. [<a href="http://queue.acm.org/detail.cfm?id=1531242">article</a>]</li>
</ul>

<h2 id="steve-vinoski--addressing-network-congestion-in-riak-clusters">Steve Vinoski — Addressing Network Congestion in Riak Clusters</h2>

<ul>
  <li>Slides: <a href="https://dl.dropboxusercontent.com/u/10363968/vinoski-addressing-network-congestion-in-riak.pdf">Dropbox</a></li>
  <li>
    <p>Video: <a href="http://www.youtube.com/watch?v=Y6PG6hkUHPM">YouTube</a></p>
  </li>
  <li>Riak — A distributed highly available eventually consistent highly scalable open source key-value database written primarily in Erlang, built for operational ease.</li>
  <li>Riak TCP traffic:
    <ol>
      <li>Client requests: made to any node in the ring</li>
      <li>Coordination: node receiving client request coordinates the operation across the owning replicas</li>
      <li>Gossip: Riak nodes share ring state via a gossip protocol</li>
      <li>Active Anti-Entropy: nodes actively verify and repair data consistency across the ring</li>
      <li>Erlang: distributed Erlang nodes form a full mesh and do periodic node availability checks</li>
      <li>Handoff</li>
    </ol>
  </li>
  <li>TCP incast.</li>
  <li>Low Extra Delay Background Transport (LEDBAT).</li>
  <li>Micro Transport Protocol (μTP, or uTP).</li>
</ul>

<h3 id="resources-8">Resources</h3>

<ul>
  <li>Amazon’s Dynamo Paper and <a href="http://docs.basho.com/riak/latest/theory/dynamo/">Riak</a>.</li>
  <li><a href="https://github.com/bittorrent/libutp">libutp</a> — The uTorrent Transport Protocol library.</li>
  <li><a href="https://github.com/basho-labs/gen_utp">gen_utp</a> — an API and driver for the uTP protocol.</li>
</ul>

<h2 id="mahesh-paolini-subramanya--finite-state-machines-why-the-fear">Mahesh Paolini-Subramanya — Finite State Machines. Why the fear?</h2>

<ul>
  <li>Slides: <a href="http://www.slideshare.net/dieswaytoofast/genfsm-the-erlang-behavior-that-gets-no-respect">Slideshare</a></li>
</ul>

<p><blockquote><p>Sitting behind @webyrd, @dfried00, Sussman, and @joeerl in @dieswaytoofast’s finite state machine talk.</p><footer><strong>@gazoombo</strong> <cite><a href='https://twitter.com/gazoombo/statuses/354991392247906305'>twitter.com/gazoombo/statuses/&hellip;</a></cite></footer></blockquote></p>

<p><img class="center" src="https://pbs.twimg.com/media/BO0uyloCAAAS7X4.jpg"></p>

<ul>
  <li>Write a project in C++ or Java and you’re creating work for 5 other devs. Write it in Erlang and you’re done.</li>
  <li>There is a special place in hell for the people who came up with the Oauth 2.0 spec.</li>
  <li>Everything is an FSM. Problem with actually modeling this is complexity of large FSMs. Answer is encapsulation.</li>
  <li>Design your system as a big FSM that is a collection of little FSMs. Only transition between them as needed.</li>
</ul>

<h2 id="sean-cribbs-chris-meiklejohn--functional-web-applications-with-webmachine">Sean Cribbs, Chris Meiklejohn — Functional Web Applications with Webmachine</h2>

<p>The keyword here is <em>Functional</em>.</p>

<ul>
  <li>Slides: <a href="https://github.com/strangeloop/lambdajam2013/blob/master/slides/CribbsMeiklejohn-Webmachine.pdf">GitHub</a></li>
  <li>Tutorial: <a href="https://github.com/cmeiklejohn/webmachine-tutorial">GitHub</a></li>
  <li>Webmachine <a href="https://github.com/basho/webmachine/wiki/Diagram">diagram</a></li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git clone git@github.com:cmeiklejohn/webmachine-tutorial.git
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><img class="center" src="/images/posts/webmachine-diagram.png"></p>

<pre><code>git checkout hello-world
</code></pre>

<ul>
  <li>f(ReqData,State) -&gt; {RetV,ReqData,State}.</li>
  <li><code>iolist()</code></li>
</ul>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>src/tweeter_resource.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nf">init</span><span class="p">([])</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">{</span><span class="n">ok</span><span class="p">,</span> <span class="p">[]}.</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">to_html</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">State</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">{[</span><span class="err">“&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">html</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="err">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">body</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="err">”</span><span class="p">,</span> <span class="nn">wrq</span><span class="p">:</span><span class="nf">get_req_header</span><span class="p">(</span><span class="err">“</span><span class="n">host</span><span class="err">”</span><span class="p">,</span> <span class="nv">ReqData</span><span class="p">),</span> <span class="err">“&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">/</span><span class="n">body</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="err">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">/</span><span class="n">html</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="err">”</span><span class="p">],</span>
</span><span class='line'>     <span class="nv">ReqData</span><span class="p">,</span>
</span><span class='line'>     <span class="nv">State</span><span class="p">}.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Supervisor: resources, routes, dispatch</p>

<pre><code>git checkout -f load-tweets
</code></pre>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>src/tweeter_sup.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nf">init</span><span class="p">([])</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="err">…</span>
</span><span class='line'>    <span class="nv">Resources</span> <span class="o">=</span> <span class="p">[</span><span class="n">tweeter_wm_tweet_resource</span><span class="p">,</span> <span class="n">tweeter_wm_asset_resource</span><span class="p">],</span>
</span><span class='line'>    <span class="nv">Dispatch</span> <span class="o">=</span> <span class="nn">lists</span><span class="p">:</span><span class="nf">flatten</span><span class="p">([</span><span class="nv">Module</span><span class="p">:</span><span class="nf">routes</span><span class="p">()</span> <span class="p">||</span> <span class="nv">Module</span> <span class="err">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">-</span> <span class="nv">Resources</span><span class="p">]),</span>
</span><span class='line'>    <span class="err">…</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>src/tweeter_wm_tweet_resource.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nf">routes</span><span class="p">()</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">[{[</span><span class="err">“</span><span class="n">tweets</span><span class="err">”</span><span class="p">],</span> <span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="p">[]}].</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>src/tweeter_wm_asset_resource.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nf">routes</span><span class="p">()</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">[{[</span><span class="err">””</span><span class="p">],</span> <span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="p">[]},</span> <span class="p">{[</span><span class="err">’</span><span class="o">*</span><span class="err">’</span><span class="p">],</span> <span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="p">[]}].</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Media Types</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>src/tweeter_wm_tweet_resource.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nf">content_types_provided</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">{[{</span><span class="err">“</span><span class="n">application</span><span class="o">/</span><span class="n">json</span><span class="err">”</span><span class="p">,</span> <span class="n">to_json</span><span class="p">},</span>
</span><span class='line'>      <span class="p">{</span><span class="err">“</span><span class="n">application</span><span class="o">/</span><span class="n">x</span><span class="o">-</span><span class="n">erlang</span><span class="o">-</span><span class="n">binary</span><span class="err">”</span><span class="p">,</span> <span class="n">to_erlang</span><span class="p">}],</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}.</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">to_json</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">Tweets</span> <span class="o">=</span> <span class="p">[</span><span class="nv">Value</span> <span class="p">||</span> <span class="p">[{_</span><span class="nv">Key</span><span class="p">,</span> <span class="nv">Value</span><span class="p">}]</span> <span class="err">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">-</span> <span class="nn">ets</span><span class="p">:</span><span class="nf">match</span><span class="p">(</span><span class="n">tweets</span><span class="p">,</span> <span class="err">‘</span><span class="sc">$1</span><span class="err">’</span><span class="p">)],</span>
</span><span class='line'>    <span class="nv">Content</span> <span class="o">=</span> <span class="nn">mochijson2</span><span class="p">:</span><span class="nf">encode</span><span class="p">({</span><span class="n">struct</span><span class="p">,</span> <span class="p">[{</span><span class="n">tweets</span><span class="p">,</span> <span class="nv">Tweets</span><span class="p">}]}),</span>
</span><span class='line'>    <span class="p">{</span><span class="nv">Content</span><span class="p">,</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}.</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">to_erlang</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">Tweets</span> <span class="o">=</span> <span class="p">[</span><span class="nv">Value</span> <span class="p">||</span> <span class="p">[{_</span><span class="nv">Key</span><span class="p">,</span> <span class="nv">Value</span><span class="p">}]</span> <span class="err">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">-</span> <span class="nn">ets</span><span class="p">:</span><span class="nf">match</span><span class="p">(</span><span class="n">tweets</span><span class="p">,</span> <span class="err">‘</span><span class="sc">$1</span><span class="err">’</span><span class="p">)],</span>
</span><span class='line'>    <span class="nv">Content</span> <span class="o">=</span> <span class="nb">term_to_binary</span><span class="p">(</span><span class="nv">Tweets</span><span class="p">),</span>
</span><span class='line'>    <span class="p">{</span><span class="nv">Content</span><span class="p">,</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -i -H “Accept:application/x-erlang-binary” “http://localhost:8080/tweets”
</span><span class='line'>HTTP/1.1 200 OK
</span><span class='line'>Vary: Accept
</span><span class='line'>Server: MochiWeb/1.1 WebMachine/1.10.0 (never breaks eye contact)
</span><span class='line'>Content-Type: application/x-erlang-binary&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>?llhdavatarmZhttps://si0.twimg.com/profile_images/2536088319/4sl2go65was3o0km520j_reasonably_small.jpeghdmessageCaremad.jlhdavatarm\https://si0.twimg.com/profile_images/3778090444/e4fde2cad4b921cd8c07fcecc0ff2fff_bigger.jpeghdmessagemRubby is over!jlhdavatarmZhttps://si0.twimg.com/profile_images/2536088319/4sl2go65was3o0km520j_reasonably_small.jpeghdmessagemYou boys having a taste?jj</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><code>resource_exists</code></p>

<pre><code>git checkout -f tweet-urls
</code></pre>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>src/tweeter_wm_tweet_resource.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nf">routes</span><span class="p">()</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">[{[</span><span class="err">“</span><span class="n">tweets</span><span class="err">”</span><span class="p">,</span> <span class="n">tweet_id</span><span class="p">],</span> <span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="p">[]}].</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">tweet_id</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="n">time_from_timestamp</span><span class="p">(</span><span class="nn">wrq</span><span class="p">:</span><span class="nf">path_info</span><span class="p">(</span><span class="n">tweet_id</span><span class="p">,</span> <span class="nv">ReqData</span><span class="p">)).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">resource_exists</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">maybe_retrieve_tweet</span><span class="p">(</span><span class="nv">Context</span><span class="p">,</span> <span class="n">tweet_id</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">))</span> <span class="k">of</span>
</span><span class='line'>        <span class="p">{</span><span class="n">true</span><span class="p">,</span> <span class="nv">NewContext</span><span class="p">}</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="p">{</span><span class="n">true</span><span class="p">,</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">NewContext</span><span class="p">};</span>
</span><span class='line'>        <span class="p">{</span><span class="n">false</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}</span>   <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="p">{</span><span class="n">false</span><span class="p">,</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}</span>
</span><span class='line'>    <span class="k">end</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl http://localhost:8080/tweets
</span><span class='line'>{“tweets”:[
</span><span class='line'>  {“avatar”:”https://si0.twimg.com/profile_images/2536088319/4sl2go65was3o0km520j_reasonably_small.jpeg”,”message”:”Caremad.”,”id”:”1376843311536798”},
</span><span class='line'>  {“avatar”:”https://si0.twimg.com/profile_images/3778090444/e4fde2cad4b921cd8c07fcecc0ff2fff_bigger.jpeg”,”message”:”Rubby is over!”,”id”:”1376843311536799”},
</span><span class='line'>  {“avatar”:”https://si0.twimg.com/profile_images/2536088319/4sl2go65was3o0km520j_reasonably_small.jpeg”,”message”:”You boys having a taste?”,”id”:”1376843311536800”}]}</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -i http://localhost:8080/tweets/1376843311536798
</span><span class='line'>HTTP/1.1 200 OK&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>{“tweet”:{“avatar”:”https://si0.twimg.com/profile_images/2536088319/4sl2go65was3o0km520j_reasonably_small.jpeg”,”message”:”Caremad.”}}</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -i http://localhost:8080/tweets/42
</span><span class='line'>HTTP/1.1 404 Object Not Found&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;html>&lt;head>&lt;title>404 Not Found&lt;/title>&lt;/head>&lt;body>&lt;h1>Not Found&lt;/h1>The requested document was not found on this server.&lt;p>&lt;hr />&lt;address>mochiweb+webmachine web server&lt;/address></span></code></pre></td></tr></table></div></figure></notextile></div>

`POST`, response header

    git checkout -f create-tweets

<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>src/tweeter_wm_tweets_resource.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nf">allowed_methods</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">{[</span><span class="n">&#39;HEAD&#39;</span><span class="p">,</span> <span class="n">&#39;GET&#39;</span><span class="p">,</span> <span class="n">&#39;POST&#39;</span><span class="p">],</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}.</span>
</span><span class='line'>
</span><span class='line'><span class="nf">post_is_create</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">{</span><span class="n">true</span><span class="p">,</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}.</span>
</span><span class='line'>
</span><span class='line'><span class="nf">create_path</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">maybe_create_tweet</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="k">of</span>
</span><span class='line'>        <span class="p">{</span><span class="n">true</span><span class="p">,</span> <span class="nv">NewContext</span><span class="p">}</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>            <span class="p">{</span><span class="nv">Id</span><span class="p">,</span> <span class="p">_}</span> <span class="o">=</span> <span class="nv">NewContext</span><span class="nl">#context.tweet</span><span class="p">,</span>
</span><span class='line'>            <span class="nv">Resource</span> <span class="o">=</span> <span class="s">&quot;/tweets/&quot;</span> <span class="o">++</span> <span class="nb">binary_to_list</span><span class="p">(</span><span class="n">time_to_timestamp</span><span class="p">(</span><span class="nv">Id</span><span class="p">)),</span>
</span><span class='line'>            <span class="nv">NewReqData</span> <span class="o">=</span> <span class="nn">wrq</span><span class="p">:</span><span class="nf">set_resp_header</span><span class="p">(</span><span class="s">&quot;Location&quot;</span><span class="p">,</span> <span class="nv">Resource</span><span class="p">,</span> <span class="nv">ReqData</span><span class="p">),</span>
</span><span class='line'>            <span class="p">{</span><span class="nv">Resource</span><span class="p">,</span> <span class="nv">NewReqData</span><span class="p">,</span> <span class="nv">NewContext</span><span class="p">};</span>
</span><span class='line'>        <span class="p">{</span><span class="n">false</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>            <span class="p">{</span><span class="s">&quot;/users&quot;</span><span class="p">,</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}</span>
</span><span class='line'>    <span class="k">end</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'><span class="nf">content_types_accepted</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">{[{</span><span class="s">&quot;application/json&quot;</span><span class="p">,</span> <span class="n">from_json</span><span class="p">}],</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}.</span>
</span><span class='line'>
</span><span class='line'><span class="nf">from_json</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="k">case</span> <span class="n">maybe_create_tweet</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="k">of</span>
</span><span class='line'>        <span class="p">{</span><span class="n">true</span><span class="p">,</span> <span class="nv">NewContext</span><span class="p">}</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>            <span class="p">{_,</span> <span class="nv">Tweet</span><span class="p">}</span> <span class="o">=</span> <span class="nv">NewContext</span><span class="nl">#context.tweet</span><span class="p">,</span>
</span><span class='line'>            <span class="nv">Response</span> <span class="o">=</span> <span class="nn">mochijson2</span><span class="p">:</span><span class="nf">encode</span><span class="p">({</span><span class="n">struct</span><span class="p">,</span> <span class="p">[{</span><span class="n">tweet</span><span class="p">,</span> <span class="nv">Tweet</span><span class="p">}]}),</span>
</span><span class='line'>            <span class="nv">NewReqData</span> <span class="o">=</span> <span class="nn">wrq</span><span class="p">:</span><span class="nf">set_resp_body</span><span class="p">(</span><span class="nv">Response</span><span class="p">,</span> <span class="nv">ReqData</span><span class="p">),</span>
</span><span class='line'>            <span class="p">{</span><span class="n">true</span><span class="p">,</span> <span class="nv">NewReqData</span><span class="p">,</span> <span class="nv">NewContext</span><span class="p">};</span>
</span><span class='line'>        <span class="p">{</span><span class="n">false</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>            <span class="p">{</span> <span class="p">{</span><span class="n">halt</span><span class="p">,</span> <span class="mi">409</span><span class="p">},</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}</span>
</span><span class='line'>    <span class="k">end</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -i -X POST -H "Content-Type:application/json" \
</span><span class='line'>      http://localhost:8080/tweets --data @-
</span><span class='line'>{
</span><span class='line'>  "tweet":{
</span><span class='line'>    "message":"testing...",
</span><span class='line'>    "avatar":"https://si0.twimg.com/profile_images/3778090444/e4fde2cad4b921cd8c07fcecc0ff2fff_bigger.jpeg"
</span><span class='line'>  }
</span><span class='line'>}
</span><span class='line'>HTTP/1.1 201 Created
</span><span class='line'>Location: /tweets/1376847941255278
</span><span class='line'>Content-Type: application/json
</span><span class='line'>
</span><span class='line'>{"tweet":{"message":"testing...","avatar":"https://si0.twimg.com/profile_images/3778090444/e4fde2cad4b921cd8c07fcecc0ff2fff_bigger.jpeg"}}</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -i -X POST -H "Content-Type:application/xml" \
</span><span class='line'>      http://localhost:8080/tweets --data @-
</span><span class='line'>{
</span><span class='line'>  "tweet":{
</span><span class='line'>    "message":"testing...",
</span><span class='line'>    "avatar":"https://si0.twimg.com/profile_images/3778090444/e4fde2cad4b921cd8c07fcecc0ff2fff_bigger.jpeg"
</span><span class='line'>  }
</span><span class='line'>}
</span><span class='line'>HTTP/1.1 415 Unsupported Media Type
</span><span class='line'>Location: /tweets/1376848621307991
</span><span class='line'>Content-Type: text/html
</span><span class='line'>
</span><span class='line'>&lt;html>&lt;head>&lt;title>415 Unsupported Media Type&lt;/title>&lt;/head>&lt;body>&lt;h1>Unsupported Media Type&lt;/h1>Unsupported Media Type&lt;p>&lt;hr />&lt;address>mochiweb+webmachine web server&lt;/address></span></code></pre></td></tr></table></div></figure></notextile></div>

Note: `create_path` is called before `content_types_accepted`

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -i -X POST -H "Content-Type:application/xml" \
</span><span class='line'>      http://localhost:8080/tweets --data @-
</span><span class='line'>&lt;tweet>
</span><span class='line'>  &lt;message>testing...&lt;/message>
</span><span class='line'>  &lt;avatar>https://si0.twimg.com/profile_images/3778090444/e4fde2cad4b921cd8c07fcecc0ff2fff_bigger.jpeg&lt;/avatar>
</span><span class='line'>&lt;/tweet>
</span><span class='line'>HTTP/1.1 500 Internal Server Error
</span><span class='line'>Content-Type: text/html
</span><span class='line'>
</span><span class='line'>&lt;html>&lt;head>&lt;title>500 Internal Server Error&lt;/title>&lt;/head>&lt;body>&lt;h1>Internal Server Error&lt;/h1>The server encountered an error while processing this request:&lt;br />&lt;pre>{"create_path not a string",
</span><span class='line'> {error,
</span><span class='line'>     {...}}}&lt;/pre>&lt;p>&lt;hr />&lt;address>mochiweb+webmachine web server&lt;/address></span></code></pre></td></tr></table></div></figure></notextile></div>

ETags, caching, preconditions

    git checkout -f etag-tweets

<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>src/tweeter_wm_tweets_resource.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nf">generate_etag</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">{_,</span> <span class="nv">NewContext</span><span class="p">}</span> <span class="o">=</span>  <span class="n">maybe_retrieve_tweets</span><span class="p">(</span><span class="nv">Context</span><span class="p">),</span>
</span><span class='line'>    <span class="nv">ETag</span> <span class="o">=</span> <span class="nn">mochihex</span><span class="p">:</span><span class="nf">to_hex</span><span class="p">(</span><span class="nn">erlang</span><span class="p">:</span><span class="nb">phash2</span><span class="p">(</span><span class="nv">NewContext</span><span class="nl">#context.tweets</span><span class="p">)),</span>
</span><span class='line'>    <span class="p">{</span><span class="nv">ETag</span><span class="p">,</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">NewContext</span><span class="p">}.</span>
</span><span class='line'>
</span><span class='line'><span class="nf">last_modified</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">Id</span> <span class="o">=</span> <span class="nn">ets</span><span class="p">:</span><span class="nf">last</span><span class="p">(</span><span class="n">tweets</span><span class="p">),</span>
</span><span class='line'>    <span class="p">{</span><span class="nn">calendar</span><span class="p">:</span><span class="nf">now_to_datetime</span><span class="p">(</span><span class="nv">Id</span><span class="p">),</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -i http://localhost:8080/tweets
</span><span class='line'>HTTP/1.1 200 OK
</span><span class='line'>Last-Modified: Sun, 18 Aug 2013 21:44:50 GMT
</span><span class='line'>ETag: "30008d7"
</span><span class='line'>
</span><span class='line'>{"tweets":[
</span><span class='line'>  {"avatar":"https://si0.twimg.com/profile_images/2536088319/4sl2go65was3o0km520j_reasonably_small.jpeg","message":"Caremad.","id":"1376860726482913"},
</span><span class='line'>  {"avatar":"https://si0.twimg.com/profile_images/3778090444/e4fde2cad4b921cd8c07fcecc0ff2fff_bigger.jpeg","message":"Rubby is over!","id":"1376860726482914"},
</span><span class='line'>  {"avatar":"https://si0.twimg.com/profile_images/2536088319/4sl2go65was3o0km520j_reasonably_small.jpeg","message":"You boys having a taste?","id":"1376860726482915"}]}</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -i -H 'If-None-Match:"30008d7"' http://localhost:8080/tweets
</span><span class='line'>HTTP/1.1 304 Not Modified
</span><span class='line'>ETag: "30008d7"</span></code></pre></td></tr></table></div></figure></notextile></div>

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -i -H 'If-Modified-Since:Sun, 18 Aug 2013 21:45:41 GMT' http://localhost:8080/tweets
</span><span class='line'>HTTP/1.1 304 Not Modified
</span><span class='line'>ETag: "30008d7"</span></code></pre></td></tr></table></div></figure></notextile></div>

Authorization, CSRF

    git checkout -f csrf

<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>src/tweeter_wm_tweets_resource.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nf">forbidden</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">{</span><span class="nn">tweeter_security</span><span class="p">:</span><span class="nf">is_protected</span><span class="p">(</span><span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">),</span> <span class="nv">ReqData</span><span class="p">,</span> <span class="nv">Context</span><span class="p">}.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

Visual debugger

    git checkout -f debugger

<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>src/tweeter_wm_asset_resource.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nf">init</span><span class="p">([])</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nn">wmtrace_resource</span><span class="p">:</span><span class="nf">add_dispatch_rule</span><span class="p">(</span><span class="s">&quot;wmtrace&quot;</span><span class="p">,</span> <span class="s">&quot;/tmp&quot;</span><span class="p">),</span>
</span><span class='line'>    <span class="p">{</span> <span class="p">{</span><span class="nb">trace</span><span class="p">,</span> <span class="s">&quot;/tmp&quot;</span><span class="p">},</span> <span class="nl">#context</span><span class="p">{}}.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<img class="center" src="/images/posts/webmachine-debugger-1.png">

<img class="center" src="/images/posts/webmachine-debugger-2.png">

ErlyDTL, Dialyzer

### Resources

* Webmachine: [Request Data API](https://github.com/basho/webmachine/wiki/Request-Data-API)
* James Hague — A Ramble Through Erlang IO Lists. [[blog](http://prog21.dadgum.com/70.html)]
* Andrei Neculau — [http-decision-diagram](https://github.com/andreineculau/http-decision-diagram)


## David Nolen — Keynote

### Everything I Have Learned I Have Learned From Someone Else

* Slides: [GitHub](https://github.com/strangeloop/lambdajam2013/blob/master/slides/Nolen-EverythingIHaveLearned.pdf)
* Video: [InfoQ](http://www.infoq.com/presentations/learning-developer)

<blockquote><p>It is practically impossible to teach good programming to students that have had a prior exposure to BASIC: as potential programmers they are mentally mutilated beyond hope of regeneration.</p><footer><strong>Edsger Dijkstra</strong></footer></blockquote>

### Quotes

- We sick of the status quo, and there is a resurgence among engineers and excitement around new programming languages.
- In Clojure we can pattern match on persistent vectors and hashmaps.

<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">x</span> <span class="nv">true</span>
</span><span class='line'>      <span class="nv">y</span> <span class="nv">true</span>
</span><span class='line'>      <span class="nv">z</span> <span class="nv">true</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">match</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span><span class="p">]</span>
</span><span class='line'>    <span class="p">[</span><span class="nv">_</span> <span class="nv">false</span> <span class="nv">true</span><span class="p">]</span> <span class="mi">1</span>
</span><span class='line'>    <span class="p">[</span><span class="nv">false</span> <span class="nv">true</span> <span class="nv">_</span> <span class="p">]</span> <span class="mi">2</span>
</span><span class='line'>    <span class="p">[</span><span class="nv">_</span> <span class="nv">_</span> <span class="nv">false</span><span class="p">]</span> <span class="mi">3</span>
</span><span class='line'>    <span class="p">[</span><span class="nv">_</span> <span class="nv">_</span> <span class="nv">true</span><span class="p">]</span> <span class="mi">4</span>
</span><span class='line'>    <span class="ss">:else</span> <span class="mi">5</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">match</span> <span class="p">[</span><span class="nv">x</span><span class="p">]</span>
</span><span class='line'>  <span class="p">[{</span><span class="ss">:a</span> <span class="nv">_</span> <span class="ss">:b</span> <span class="mi">2</span><span class="p">}]</span> <span class="mi">1</span>
</span><span class='line'>  <span class="p">[{</span><span class="ss">:a</span> <span class="mi">1</span> <span class="ss">:b</span> <span class="mi">1</span><span class="p">}]</span> <span class="mi">2</span>
</span><span class='line'>  <span class="p">[{</span><span class="ss">:c</span> <span class="mi">3</span> <span class="ss">:d</span> <span class="nv">_</span> <span class="ss">:e</span> <span class="mi">4</span><span class="p">}]</span> <span class="mi">3</span>
</span><span class='line'>  <span class="ss">:else</span> <span class="mi">4</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

- The best way to predict the future is to read papers and *engineer* it.

### Papers

- Phil Bagwell — Ideal Hash Trees [[pdf](http://lampwww.epfl.ch/papers/idealhashtrees.pdf)]
- Phil Bagwell, Tiark Rompf — RRB-Trees: Efficient Immutable Vectors [[pdf](http://infoscience.epfl.ch/record/169879/files/RMTrees.pdf)]
- William E. Byrd — Relational Programming in miniKanren: Techniques, Applications, and Implementations [[pdf](https://scholarworks.iu.edu/dspace/bitstream/handle/2022/8777/Byrd_indiana_0093A_10344.pdf)]
- David C. Bender, Lindsey Kuper, William E. Byrd, Daniel P. Friedman — Efficient representations for triangular substitutions: A comparison in miniKanren [[pdf](http://www.cs.indiana.edu/~lkuper/papers/walk.pdf)]
- William A. Kornfeld — Equality for Prolog [[pdf](http://www.ijcai.org/Past%20Proceedings/IJCAI-83-VOL-1/PDF/120.pdf)]
- Philip Wadler, Stephen Blott — Ho to make *ad-hoc* polymorphism less *ad hoc* [[ps](http://homepages.inf.ed.ac.uk/wadler/papers/class/class.ps)]
- James Cheney, Christian Urban — Nominal Logic Programming [[pdf](http://arxiv.org/pdf/cs/0609062v2.pdf)]
- Alexey Radul, Gerald Jay Sussman — The Art of the Propagator [[pdf](http://web.mit.edu/~axch/www/art.pdf)]
- Craig Chambers, Weimin Chen — Efficient Multiple and Predicate Dispatching [[pdf](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.37.6735&amp;rep=rep1&amp;type=pdf)]
- Luc Maranget — Compiling Pattern Matching to good Decision Trees [[pdf](http://www.cs.tufts.edu/~nr/cs257/archive/luc-maranget/jun08.pdf)]
- Philip Wadler — Views: A way for pattern matching to cohabit with data abstraction [[ps](http://homepages.inf.ed.ac.uk/wadler/papers/view/view.ps)]
- Sam Tobin-Hochstadt — Extensible Pattern Matching in an Extensible Language [[pdf](http://arxiv.org/pdf/1106.2578v1.pdf)]
- Anurag Mendhekar, Gregor Kiczales, John Lamping — Compilation Strategies as Objects [[pdf](http://cl-projects.org/project.OLD/suave/darcs/_darcs/current/experimental/suavescript-old/research/kiczales-compilation-strategies-as-objects.pdf)]
- Emden R. Gansner, John H. Reppy — A Multi-threaded Higher-order User Interface Toolkit [[ps](http://www.cs.tufts.edu/~nr/cs257/archive/john-reppy/exene.ps)]
- Conal Elliott, Paul Hudak — Functional Reactive Animation [[pdf](http://conal.net/papers/icfp97/icfp97.pdf)]

### Books

- Chris Okasaki — Purely Functional Data Structures [[pdf](http://www.cs.cmu.edu/~rwh/theses/okasaki.pdf)]
- Daniel P. Friedman, William E. Byrd, Oleg Kiselyov — The Reasoned Schemer [[MIT](http://mitpress.mit.edu/books/reasoned-schemer)]
- Peter Van Roy, Seif Haridi — Concepts, Techniques, and Models of Computer Programming [[MIT](http://mitpress.mit.edu/books/concepts-techniques-and-models-computer-programming)]
- Gregor Kiczales, Jim des Rivieres, Daniel G. Bobrow — The Art of the Metaobject Protocol [[MIT](http://mitpress.mit.edu/books/art-metaobject-protocol)]
- C. A. R. Hoare — Communicating Sequential Processes [[pdf](http://www.usingcsp.com/cspbook.pdf)]

### Resources

- core.logic — [GitHub](https://github.com/clojure/core.logic)
- core.match — [GitHub](https://github.com/clojure/core.match)


## Bonus 1: Joe Armstrong @ CEUG — 26 Years With Erlang

Video: [YouTube](http://www.youtube.com/watch?v=HCwRGHj5jOE)

- If you are an academic you think to develop a programming language in three or four years because that's the time it takes to get your PhD, then you finish your PhD and the whole world will use it. It doesn't work like that. You got to do quite few other things.
- That's what we did in 1985, before the Internet: we were creating programming languages.
- Version 1.03 lost in the mists of time.
- When Prolog program goes wrong, it says *No*.

<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='prolog'><span class='line'><span class="s-Atom">uni</span> <span class="s-Atom">---&amp;gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nf">case</span><span class="p">(</span><span class="s-Atom">wait</span><span class="p">,[</span>
</span><span class='line'>        <span class="s-Atom">n</span> <span class="s-Atom">=&amp;gt</span><span class="p">;</span> <span class="p">[</span><span class="s-Atom">term</span><span class="p">,</span><span class="s-Atom">exit</span><span class="p">],</span>
</span><span class='line'>        <span class="s-Atom">h</span> <span class="s-Atom">=&amp;gt</span><span class="p">;</span> <span class="p">[</span><span class="s-Atom">hold</span><span class="p">,</span>
</span><span class='line'>              <span class="nf">case</span><span class="p">(</span><span class="s-Atom">new_call</span><span class="p">,[</span>
</span><span class='line'>                  <span class="s-Atom">connected</span> <span class="s-Atom">=&amp;gt</span><span class="p">;</span> <span class="s-Atom">multi</span><span class="p">,</span>
</span><span class='line'>                  <span class="s-Atom">n</span> <span class="s-Atom">=&amp;gt</span><span class="p">;</span> <span class="nf">case</span><span class="p">(</span><span class="s-Atom">gone_away</span><span class="p">,[</span>
</span><span class='line'>                           <span class="s-Atom">yes</span> <span class="s-Atom">=&amp;gt</span><span class="p">;</span> <span class="s-Atom">exit</span><span class="p">,</span>
</span><span class='line'>                           <span class="s-Atom">no</span> <span class="s-Atom">=&amp;gt</span><span class="p">;</span> <span class="p">[</span><span class="s-Atom">conv</span><span class="p">,</span><span class="s-Atom">uni</span><span class="p">]</span>
</span><span class='line'>                       <span class="p">]),</span>
</span><span class='line'>                  <span class="s-Atom">h</span> <span class="s-Atom">=&amp;gt</span><span class="p">;</span> <span class="p">[</span><span class="s-Atom">conv</span><span class="p">,</span><span class="s-Atom">uni</span><span class="p">]</span>
</span><span class='line'>              <span class="p">])</span>
</span><span class='line'>             <span class="p">]</span>
</span><span class='line'>    <span class="p">]).</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

- This diagrams are nested state machines.
- You do not program the abnormal things, you do not make any decisions about how to program the stuff which is outside of the specification. What you do is you crash your program and let somebody else to resolve the problem and put back all the invariants.
- It took four days to re-write the whole Erlang.
- That's the entire documentation of Erlang 1.05

<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>h                help
</span><span class='line'>reset            reset all queues
</span><span class='line'>reset_erlang     kill all erlang definitions
</span><span class='line'>load(F)          load erlang file &lt;f>.erlang
</span><span class='line'>load             load the same file as before
</span><span class='line'>load(?)          what is the current load file
</span><span class='line'>what_erlang      list all loaded erlang files
</span><span class='line'>go               reduce the main queue to zero
</span><span class='line'>send(A,B,C)      perform a send to the main queue
</span><span class='line'>send(A,B)        perform a send to the main queue
</span><span class='line'>cq               see queue — print main queue
</span><span class='line'>wait_queue(N)    print wait_queue(N)
</span><span class='line'>cf               see frozen — print all frozen states
</span><span class='line'>cqns             see all equations
</span><span class='line'>cqns(N)          see equation(N)
</span><span class='line'>start(Mod,Goal)  starts Goal in Mod
</span><span class='line'>top              top loop run system
</span><span class='line'>q                quit top loop
</span><span class='line'>open_dots(Node)  opens Node
</span><span class='line'>talk(N)          N=1 verbose, =0 silent
</span><span class='line'>peep(M)          set peeping point on M
</span><span class='line'>no_peep(M)       unset peeping point on M
</span><span class='line'>vsn(X)           erlang vsn number is X</span></code></pre></td></tr></table></div></figure></notextile></div>

- Don't speculate about performance. Write the program, run it, and measure it.
- Robert collected the whole pile of papers on how abstract machines worked. I borrowed this file and took it for a weekend, and I read every single paper from beginning to end… and I understood nothing. Then Monday morning I suddenly woke up and I understood it.
- There is no garbage collection in atom table.
- The original Erlang movie was made for ISS 90. And we had script!
- Robert wanted to buy a train set on the money from the lab.
- "Amazing but true! Blindingly fast!"
- 8 Dec 1995, AXE-N cancelled. 1996 AXD 301 started.
- AXD 301 could switch up to 160Gb/sec. For countries of the size of Sweeden you can only sell one. I think British Telecom bought 3 or something. It was great technical success but it didn't earn any money.
- Banning things has interesting consequences. Erlang got open sourced. Four days after Erlang was banned all people who developed it left Ericsson and started their own company Bluetail.
- Now DNA of Erlang is spreading through various companies.


## Bonus 2: Joe Armstrong @ CEUG — Sherlock's Last Case

Video: [YouTube](http://www.youtube.com/watch?v=hh4tmDB9iQI)

- "How can you be more efficient programmer? By not programming."
- When you program for 20–30 years, the "make it work" challenge is gone away. It's more challenging to think what problem you are going to solve.
- The problem I've been thinking for the last five years is how to organize the data, how to organize ideas.
- Value store is a key-value store without keys. How to get the data out of this database?
- Sherlock's Problem: There is $X$, and there are thousands of $Y_i$. Which $Y_i$ is the nearest to $X$?
- The categorization problem is extremly difficult. That's why object-oriented programming is stupid.
- Concurrency oriented programming is a physical modelling.
- Measures of similarity. TF*IDF.
- Naive Bayesian

$$
P(A|B) P(B) = P(B|A) P(A)
$$

- Normalized compression difference: If $A$ and $B$ are similar then size(compress($A$++$B$) will be wee bit larger than size(compress($A$)). It's insensitive to choice of compression algorithm.
- Idea for IDE: Social programming network. It shows all the people working on the code similar to what you are typing.

### Q &amp; A

- Macros and include files should be removed from the language.
- Maybe atoms should be garbage collected.
- The biggest problem in building technical systems is 'connecting thing together' problem.
- If I need to write a language, it wouldn't be programming language. I would write a protocol description language.
- Principle of observational equivalence.
- [UBF](http://ubf.github.io/ubf/).
- "There are languages that people bitch about, and there are languages that nobody's using." — Bjarne Stroustrup
- Scale change. Petabyte change is enormously interesting.
- We need to make cryptography available to all the people.
- Take the data out of the cloud, and put it into your home clouds.
- NSA will kill Google and Facebook.


## Epilogue

<blockquote><p>As I leave #LambdaJam I'm particularly happy at my improved sense of being able to think about OO stuff in FP terms. That may serve me well.</p><footer><strong>@kaleidic</strong> <cite><a href='https://twitter.com/kaleidic/statuses/355327906764959744'>twitter.com/kaleidic/statuses/&hellip;</a></cite></footer></blockquote>

<blockquote><p>Life returning to normal. Have been suffering for PCSD (Post Conference Stress Disorder) — too many ideas in too short time + Jet Lag</p><footer><strong>@joeerl</strong> <cite><a href='https://twitter.com/joeerl/statuses/356672073675972609'>twitter.com/joeerl/statuses/&hellip;</a></cite></footer></blockquote>

</f></p></body></html></p></body></html></p></body></html>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sleeping Barber in Erlang]]></title>
    <link href="http://blog.ndpar.com/2013/06/11/sleeping-barber-in-erlang/"/>
    <updated>2013-06-11T20:43:00-04:00</updated>
    <id>http://blog.ndpar.com/2013/06/11/sleeping-barber-in-erlang</id>
    <content type="html"><![CDATA[<p>After working on <a href="http://en.wikipedia.org/wiki/Sleeping_barber_problem"><em>Sleeping Barber</em></a> problem at <a href="http://www.meetup.com/Toronto-Coding-Dojo/events/120577762/">Coding Dojo</a> I decided to implement it in Erlang. Because Erlang is the perfect language for these sorts of problems, many people have alredy solved it in many different ways. I found at least three groups of solutions: 1) direct implementation using message passing between processes, 2) OTP solution using <em>gen_server</em>, and 3) something resembling object-oriented approach.</p>

<p>Strangely enough, I didn’t see any solution based on <a href="https://en.wikipedia.org/wiki/Finite-state_machine">FSM</a>. That is odd because this is the first thing coming to my mind when I hear this problem. To fill the gap, I’m going to solve it using <em>gen_fsm</em>, which is a standard OTP behaviour for FSM.</p>

<!-- more -->

<h2 id="overview-of-genfsm">Overview of gen_fsm</h2>

<p>In essence gen_fsm behaviour is built the same way as a <a href="/2009/11/12/state-machine-in-erlang/">naïve</a> implementation of FSM. It just hides the low-level code that deals with messages and provides integration with OTP framework. An implementation of gen_fsm behaviour consists of three parts</p>

<ul>
  <li>A <em>client API</em> that calls gen_fsm public interface</li>
  <li>gen_fsm <em>callbacks</em> required by OTP</li>
  <li>State <em>transition</em> functions</li>
</ul>

<p>We’ll see examples of all of them in a minute, but first</p>

<h2 id="dialogue">Dialogue</h2>

<p><em>Barber shop. The Barber is sleeping in the chair. Customer I comes in.</em></p>

<p><em>Customer I.</em> Good morning.<br />
<em>Barber.</em> Good morning. Please take a seat.</p>

<p><em>Barber starts shaving Customer I. Customer II comes in.</em></p>

<p><em>Customer II.</em> Good morning.<br />
<em>Barber.</em> I’m busy. You have to wait.<br />
<em>Customer II.</em> OK.</p>

<p><em>Customer II goes to waiting room. The same happens with Customers III and IV. Customer V comes in.</em></p>

<p><em>Customer V.</em> Good morning.<br />
<em>Barber.</em> Sorry Customer V. Not today.<br />
<em>Customer V.</em> Maybe tomorrow.</p>

<p><em>Customer V exits the shop. Meantime Barber finished Customer I’s haircut.</em></p>

<p><em>Barber.</em> Do you like your haircut?<br />
<em>Customer I.</em> Thank you.<br />
<em>Barber (looking at Customer II).</em> Next please.</p>

<p><em>The same happens with Customer II, III and IV. After that Barber takes the chair and sleeps.</em></p>

<h2 id="modules">Modules</h2>

<p>From this dialogue we can see we just need to implement two modules: <em>barber</em> and <em>customer</em>.
I’m not going to show all the functions here in this article, only those that are interesting from gen_fsm perspective.</p>

<p>Let’s start with <em>customer</em> because it’s simpler.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>customer.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="p">-</span><span class="ni">module</span><span class="p">(</span><span class="n">customer</span><span class="p">).</span>
</span><span class='line'><span class="p">-</span><span class="ni">behaviour</span><span class="p">(</span><span class="n">gen_fsm</span><span class="p">).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%% API</span>
</span><span class='line'><span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">start</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span> <span class="n">sit_down</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="n">done</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="n">wait</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="n">sorry</span><span class="o">/</span><span class="mi">1</span><span class="p">]).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%% Callback functions</span>
</span><span class='line'><span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">init</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="n">handle_event</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">handle_sync_event</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">handle_info</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span>
</span><span class='line'>         <span class="n">terminate</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">code_change</span><span class="o">/</span><span class="mi">4</span><span class="p">]).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%% FSM states</span>
</span><span class='line'><span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">waiting</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">served</span><span class="o">/</span><span class="mi">2</span><span class="p">]).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%%====================================================================</span>
</span><span class='line'><span class="c">%% API</span>
</span><span class='line'><span class="c">%%====================================================================&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">start</span><span class="p">()</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">{</span><span class="n">ok</span><span class="p">,</span><span class="nv">Pid</span><span class="p">}</span> <span class="o">=</span> <span class="nn">gen_fsm</span><span class="p">:</span><span class="nf">start</span><span class="p">(</span><span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[]),</span>
</span><span class='line'>    <span class="nv">Pid</span><span class="p">.</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">sit_down</span><span class="p">(</span><span class="nv">Customer</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nn">gen_fsm</span><span class="p">:</span><span class="nf">send_event</span><span class="p">(</span><span class="nv">Customer</span><span class="p">,</span> <span class="n">sit_down</span><span class="p">).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">done</span><span class="p">(</span><span class="nv">Customer</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nn">gen_fsm</span><span class="p">:</span><span class="nf">send_event</span><span class="p">(</span><span class="nv">Customer</span><span class="p">,</span> <span class="nb">exit</span><span class="p">).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">wait</span><span class="p">(</span><span class="nv">Customer</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nn">gen_fsm</span><span class="p">:</span><span class="nf">send_event</span><span class="p">(</span><span class="nv">Customer</span><span class="p">,</span> <span class="n">wait</span><span class="p">).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">sorry</span><span class="p">(</span><span class="nv">Customer</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nn">gen_fsm</span><span class="p">:</span><span class="nf">send_event</span><span class="p">(</span><span class="nv">Customer</span><span class="p">,</span> <span class="nb">exit</span><span class="p">).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%%====================================================================</span>
</span><span class='line'><span class="c">%% gen_fsm callbacks (empty functions are omitted)</span>
</span><span class='line'><span class="c">%%====================================================================&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">init</span><span class="p">([])</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">Good</span> <span class="n">morning</span><span class="p">.</span><span class="err">”</span><span class="p">),</span>
</span><span class='line'>    <span class="p">{</span><span class="n">ok</span><span class="p">,</span> <span class="n">waiting</span><span class="p">,</span> <span class="n">unow</span><span class="p">()}.</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%%====================================================================</span>
</span><span class='line'><span class="c">%% FSM states and transitions</span>
</span><span class='line'><span class="c">%%====================================================================&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">waiting</span><span class="p">(</span><span class="n">sit_down</span><span class="p">,</span> <span class="nv">WaitStart</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">I</span><span class="err">’</span><span class="n">ve</span> <span class="n">been</span> <span class="n">waiting</span> <span class="n">for</span> <span class="err">~</span><span class="n">p</span> <span class="n">sec</span><span class="p">.</span><span class="err">”</span><span class="p">,</span> <span class="p">[</span><span class="n">duration</span><span class="p">(</span><span class="nv">WaitStart</span><span class="p">)]),</span>
</span><span class='line'>    <span class="p">{</span><span class="n">next_state</span><span class="p">,</span> <span class="n">served</span><span class="p">,</span> <span class="n">unow</span><span class="p">()};</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">waiting</span><span class="p">(</span><span class="n">wait</span><span class="p">,</span> <span class="nv">StateData</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">OK</span><span class="p">.</span><span class="err">”</span><span class="p">),</span>
</span><span class='line'>    <span class="p">{</span><span class="n">next_state</span><span class="p">,</span> <span class="n">waiting</span><span class="p">,</span> <span class="nv">StateData</span><span class="p">};</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">waiting</span><span class="p">(</span><span class="nb">exit</span><span class="p">,</span> <span class="p">_</span><span class="nv">StateData</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">Maybe</span> <span class="n">tomorrow</span><span class="p">.</span><span class="err">”</span><span class="p">),</span>
</span><span class='line'>    <span class="p">{</span><span class="n">stop</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">undefined</span><span class="p">}.</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">served</span><span class="p">(</span><span class="nb">exit</span><span class="p">,</span> <span class="nv">ServiceStart</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">Thank</span> <span class="n">you</span><span class="p">.</span> <span class="nv">The</span> <span class="n">haircut</span> <span class="n">took</span> <span class="err">~</span><span class="n">p</span> <span class="n">sec</span><span class="p">.</span><span class="err">”</span><span class="p">,</span> <span class="p">[</span><span class="n">duration</span><span class="p">(</span><span class="nv">ServiceStart</span><span class="p">)]),</span>
</span><span class='line'>    <span class="p">{</span><span class="n">stop</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">undefined</span><span class="p">}.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><em>barber</em> module is little bit more complicated, because it not only calls customer’s API, it also sends events to itself.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>barber.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="p">-</span><span class="ni">module</span><span class="p">(</span><span class="n">barber</span><span class="p">).</span>
</span><span class='line'><span class="p">-</span><span class="ni">behaviour</span><span class="p">(</span><span class="n">gen_fsm</span><span class="p">).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%% API</span>
</span><span class='line'><span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">start_link</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span> <span class="n">new_customer</span><span class="o">/</span><span class="mi">1</span><span class="p">]).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%% Callback functions</span>
</span><span class='line'><span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">init</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="n">handle_event</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">handle_sync_event</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">handle_info</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span>
</span><span class='line'>         <span class="n">terminate</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">code_change</span><span class="o">/</span><span class="mi">4</span><span class="p">]).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%% FSM states</span>
</span><span class='line'><span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">busy</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">sleep</span><span class="o">/</span><span class="mi">2</span><span class="p">]).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;-</span><span class="n">define</span><span class="p">(</span><span class="nv">SERVER</span><span class="p">,</span> <span class="o">?</span><span class="nv">MODULE</span><span class="p">).</span>
</span><span class='line'><span class="p">-</span><span class="ni">define</span><span class="p">(</span><span class="no">HAIRCUT_TIME</span><span class="p">,</span> <span class="mi">5000</span><span class="p">).</span>
</span><span class='line'><span class="p">-</span><span class="ni">define</span><span class="p">(</span><span class="no">ROOM_SIZE</span><span class="p">,</span> <span class="mi">3</span><span class="p">).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;-</span><span class="n">record</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="p">{</span><span class="n">chair</span><span class="p">,</span> <span class="n">room</span> <span class="o">=</span> <span class="p">[]}).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%%====================================================================</span>
</span><span class='line'><span class="c">%% API</span>
</span><span class='line'><span class="c">%%====================================================================&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">start_link</span><span class="p">()</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nn">gen_fsm</span><span class="p">:</span><span class="nf">start_link</span><span class="p">({</span><span class="n">local</span><span class="p">,</span> <span class="o">?</span><span class="nv">SERVER</span><span class="p">},</span> <span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[]).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">new_customer</span><span class="p">(</span><span class="nv">Customer</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nn">gen_fsm</span><span class="p">:</span><span class="nf">send_event</span><span class="p">(</span><span class="o">?</span><span class="nv">SERVER</span><span class="p">,</span> <span class="p">{</span><span class="n">new</span><span class="p">,</span> <span class="nv">Customer</span><span class="p">}).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%%====================================================================</span>
</span><span class='line'><span class="c">%% gen_fsm callbacks (empty functions are omitted)</span>
</span><span class='line'><span class="c">%%====================================================================&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">init</span><span class="p">([])</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">Shop</span> <span class="n">is</span> <span class="n">open</span><span class="p">.</span> <span class="n">zzzzZ</span><span class="err">”</span><span class="p">),</span>
</span><span class='line'>    <span class="p">{</span><span class="n">ok</span><span class="p">,</span> <span class="n">sleep</span><span class="p">,</span> <span class="nl">#state</span><span class="p">{}}.</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">handle_info</span><span class="p">(</span><span class="n">finish</span><span class="p">,</span> <span class="n">busy</span><span class="p">,</span> <span class="nl">#state</span><span class="p">{</span><span class="n">chair</span> <span class="o">=</span> <span class="nv">Customer</span><span class="p">,</span> <span class="n">room</span> <span class="o">=</span> <span class="nv">Room</span><span class="p">})</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">Do</span> <span class="n">you</span> <span class="n">like</span> <span class="n">your</span> <span class="n">haircut</span> <span class="err">~</span><span class="n">p</span><span class="o">?</span><span class="err">”</span><span class="p">,</span> <span class="p">[</span><span class="nv">Customer</span><span class="p">]),</span>
</span><span class='line'>    <span class="nn">customer</span><span class="p">:</span><span class="nf">done</span><span class="p">(</span><span class="nv">Customer</span><span class="p">),</span>
</span><span class='line'>    <span class="k">case</span> <span class="nv">Room</span> <span class="k">of</span>
</span><span class='line'>        <span class="p">[</span><span class="nv">C</span> <span class="p">|</span> <span class="nv">Rest</span><span class="p">]</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>            <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">Next</span> <span class="n">please</span> <span class="err">~</span><span class="n">p</span><span class="p">.</span><span class="err">”</span><span class="p">,</span> <span class="p">[</span><span class="nv">C</span><span class="p">]),</span>
</span><span class='line'>            <span class="n">serving</span><span class="p">(</span><span class="nv">C</span><span class="p">),</span>
</span><span class='line'>            <span class="nv">NewStateData</span> <span class="o">=</span> <span class="nl">#state</span><span class="p">{</span><span class="n">chair</span> <span class="o">=</span> <span class="nv">C</span><span class="p">,</span> <span class="n">room</span> <span class="o">=</span> <span class="nv">Rest</span><span class="p">},</span>
</span><span class='line'>            <span class="p">{</span><span class="n">next_state</span><span class="p">,</span> <span class="n">busy</span><span class="p">,</span> <span class="nv">NewStateData</span><span class="p">};</span>
</span><span class='line'>        <span class="p">[]</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>            <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">Time</span> <span class="n">for</span> <span class="n">nap</span><span class="p">.</span> <span class="n">zzzzZ</span><span class="p">.</span><span class="err">”</span><span class="p">),</span>
</span><span class='line'>            <span class="p">{</span><span class="n">next_state</span><span class="p">,</span> <span class="n">sleep</span><span class="p">,</span> <span class="nl">#state</span><span class="p">{}}</span>
</span><span class='line'>    <span class="k">end</span><span class="p">.</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">serving</span><span class="p">(</span><span class="nv">Customer</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nn">customer</span><span class="p">:</span><span class="nf">sit_down</span><span class="p">(</span><span class="nv">Customer</span><span class="p">),</span>
</span><span class='line'>    <span class="nn">timer</span><span class="p">:</span><span class="nb">send_after</span><span class="p">(</span><span class="o">?</span><span class="nv">HAIRCUT_TIME</span><span class="p">,</span> <span class="n">finish</span><span class="p">).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c">%%====================================================================</span>
</span><span class='line'><span class="c">%% FSM states and transitions</span>
</span><span class='line'><span class="c">%%====================================================================&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">sleep</span><span class="p">({</span><span class="n">new</span><span class="p">,</span> <span class="nv">Customer</span><span class="p">},</span> <span class="nv">StateData</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">Good</span> <span class="n">morning</span> <span class="err">~</span><span class="n">p</span><span class="p">.</span> <span class="nv">Please</span> <span class="n">take</span> <span class="n">a</span> <span class="n">seat</span><span class="p">.</span><span class="err">”</span><span class="p">,</span> <span class="p">[</span><span class="nv">Customer</span><span class="p">]),</span>
</span><span class='line'>    <span class="n">serving</span><span class="p">(</span><span class="nv">Customer</span><span class="p">),</span>
</span><span class='line'>    <span class="nv">NewStateData</span> <span class="o">=</span> <span class="nv">StateData</span><span class="nl">#state</span><span class="p">{</span><span class="n">chair</span> <span class="o">=</span> <span class="nv">Customer</span><span class="p">},</span>
</span><span class='line'>    <span class="p">{</span><span class="n">next_state</span><span class="p">,</span> <span class="n">busy</span><span class="p">,</span> <span class="nv">NewStateData</span><span class="p">}.</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">busy</span><span class="p">({</span><span class="n">new</span><span class="p">,</span> <span class="nv">Customer</span><span class="p">},</span> <span class="nl">#state</span><span class="p">{</span><span class="n">room</span> <span class="o">=</span> <span class="nv">Room</span><span class="p">}</span> <span class="o">=</span> <span class="nv">StateData</span><span class="p">)</span>
</span><span class='line'>  <span class="k">when</span> <span class="nb">length</span><span class="p">(</span><span class="nv">Room</span><span class="p">)</span> <span class="o">==</span> <span class="o">?</span><span class="nv">ROOM_SIZE</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">Sorry</span> <span class="err">~</span><span class="n">p</span><span class="p">.</span> <span class="nv">Not</span> <span class="n">today</span><span class="p">.</span><span class="err">”</span><span class="p">,</span> <span class="p">[</span><span class="nv">Customer</span><span class="p">]),</span>
</span><span class='line'>    <span class="nn">customer</span><span class="p">:</span><span class="nf">sorry</span><span class="p">(</span><span class="nv">Customer</span><span class="p">),</span>
</span><span class='line'>    <span class="p">{</span><span class="n">next_state</span><span class="p">,</span> <span class="n">busy</span><span class="p">,</span> <span class="nv">StateData</span><span class="p">};</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">busy</span><span class="p">({</span><span class="n">new</span><span class="p">,</span> <span class="nv">Customer</span><span class="p">},</span> <span class="nl">#state</span><span class="p">{</span><span class="n">room</span> <span class="o">=</span> <span class="nv">Room</span><span class="p">}</span> <span class="o">=</span> <span class="nv">StateData</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="n">log</span><span class="p">(</span><span class="err">“</span><span class="nv">I</span><span class="err">’</span><span class="n">m</span> <span class="n">busy</span><span class="p">.</span> <span class="nv">You</span> <span class="n">have</span> <span class="n">to</span> <span class="n">wait</span><span class="p">.</span><span class="err">”</span><span class="p">),</span>
</span><span class='line'>    <span class="nn">customer</span><span class="p">:</span><span class="nf">wait</span><span class="p">(</span><span class="nv">Customer</span><span class="p">),</span>
</span><span class='line'>    <span class="nv">NewStateData</span> <span class="o">=</span> <span class="nv">StateData</span><span class="nl">#state</span><span class="p">{</span><span class="n">room</span> <span class="o">=</span> <span class="nv">Room</span> <span class="o">++</span> <span class="p">[</span><span class="nv">Customer</span><span class="p">]},</span>
</span><span class='line'>    <span class="p">{</span><span class="n">next_state</span><span class="p">,</span> <span class="n">busy</span><span class="p">,</span> <span class="nv">NewStateData</span><span class="p">}.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>To reproduce the dialogue above we evaluate the following expressions in the REPL</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nn">barber</span><span class="p">:</span><span class="nf">start_link</span><span class="p">().</span>
</span><span class='line'><span class="nn">barber</span><span class="p">:</span><span class="nf">new_customer</span><span class="p">(</span><span class="nn">customer</span><span class="p">:</span><span class="nf">start</span><span class="p">()).</span>
</span><span class='line'><span class="nn">barber</span><span class="p">:</span><span class="nf">new_customer</span><span class="p">(</span><span class="nn">customer</span><span class="p">:</span><span class="nf">start</span><span class="p">()).</span>
</span><span class='line'><span class="nn">barber</span><span class="p">:</span><span class="nf">new_customer</span><span class="p">(</span><span class="nn">customer</span><span class="p">:</span><span class="nf">start</span><span class="p">()).</span>
</span><span class='line'><span class="nn">barber</span><span class="p">:</span><span class="nf">new_customer</span><span class="p">(</span><span class="nn">customer</span><span class="p">:</span><span class="nf">start</span><span class="p">()).</span>
</span><span class='line'><span class="nn">barber</span><span class="p">:</span><span class="nf">new_customer</span><span class="p">(</span><span class="nn">customer</span><span class="p">:</span><span class="nf">start</span><span class="p">()).</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3 id="resources">Resources</h3>

<ul>
  <li><a href="https://github.com/ndpar/erlang/tree/master/barber">Source code</a> for this article.</li>
  <li><a href="http://ascii.io/a/3613">Screencast</a> reproducing the dialogue.</li>
  <li><a href="http://www.erlang.org/doc/man/gen_fsm.html">gen_fsm</a> documentation.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Joe Armstrong at MostlyErlang]]></title>
    <link href="http://blog.ndpar.com/2013/05/21/joe-armstrong-mostlyerlang/"/>
    <updated>2013-05-21T15:13:01-04:00</updated>
    <id>http://blog.ndpar.com/2013/05/21/joe-armstrong-mostlyerlang</id>
    <content type="html"><![CDATA[<p>The main guest at today’s <a href="http://mostlyerlang.wordpress.com/2013/05/21/43/">MostlyErlang</a> podcast is Joe Armstrong, the co-inventor of Erlang, a wise man, and a brilliant speaker. I listened to the podcast few times, and every time enjoyed it. I highly recommend it to all programmers regardless whether they are using Erlang or not.</p>

<p>While we are waiting for the oficial transcript, this post provides some highlights. I put here the quotes I found particularly interesting or funny.</p>

<h2 id="concurrency">Concurrency</h2>

<blockquote>
  <p>I’ve got a blog on my GitHub, and I thouhgt I’d put two different types of articles there and see what the response is. One theme I’m pursuing is “explaining to 5-year-old” theme, and the other is “technically complicated” theme.</p>
</blockquote>

<p>Then he describes the “<a href="http://joearms.github.io/2013/04/05/concurrent-and-parallel-programming.html">concurrency vs parallelism</a>” picture for 5 y.o. </p>

<blockquote>
  <p>That blog entry got 25,000 people read it, and they got 10 responses and quite a lot of criticism actually from people who know what concurrency and parallelism is. And then I compare it to some other articles I’ve written that technically deeper. There you got only few hundred people read it.</p>
</blockquote>

<p>I noticed it too. All those people, who responded with <a href="http://www.yosefk.com/blog/parallelism-and-concurrency-need-different-tools.html">long blogs</a> about concurrency, missed the point: This picture was for kids, and for kids it’s a pretty good picture. Adults should go and read the technical papers, but they didn’t.</p>

<!-- more -->

<h2 id="let-it-crash">Let it crash</h2>

<blockquote>
  <p>Once upon a time we had a Leadership Election algorithm in Erlang. We got some theoreticians involved, and they proved the algorithm to be correct. It’s been in practice for some time when we sent them a bug report, which showed that the thing elected two leaders, and we can reproduce it. And then they looked at this bug and went back at the code, and said the code is correct, but we had to make certain assumptions that this failure couldn’t happen.</p>
</blockquote>

<p>I like it. We should always keep it in mind: Before you prove anything, make sure, your assumptions are valid.</p>

<h2 id="favourite-bad-idea">Favourite bad idea</h2>

<blockquote>
  <p>The first bad idea we put in Erlang is the process priorities. I don’t think it’s documented anywhere. It’s definitely not in my book. It’s not supposed to be documented — that’s deliberate.</p>
</blockquote>

<p><a href="http://www.erlangprogramming.org/">Erlang Programming</a> mentions the process priorities on page 113, but they wrote the whole paragraph explaining why it’s a bad idea.</p>

<blockquote>
  <p>I was forced into position where I had to put them in [the language]. So I waited a few weeks and I put in an Erlang code that sets process priorities some integer, and this code didn’t do anything at all. It was commented out. I shipped the system, and then I asked “How do you like it with priorities?” And they said “Now it’s much better!”</p>
</blockquote>

<p>Brilliant! Although, it pisses them off when people eventually find what’s going on in the code.</p>

<h2 id="performance">Performance</h2>

<blockquote>
  <p>One thing I like about Erlang is it’s got pretty predictible performance model.</p>
</blockquote>

<blockquote>
  <p>There was some guy on the mailing list that said “I wrote a code that finds line breaks in the large file, and the result surprised me. I expected it to take this long, and it took a heck of a lot longer.” I wrote a little benchmark and I couldn’t see that effect. I mailed back “mine didn’t behave like that.” Then he said “There is another funny thing: the distribution of my file is not uniformed. I’ve got extremly long lines in it, and the rest are the same.” And from then it took Patrik five minutes to find a bug in the system. But if he hadn’t made an observation “this thing surprises me” and didn’t give this clue that it happened under these circumstances, that bug could be in the system for years. But people find performance thing and they don’t tell us the fact they are surprised, so we can’t debug it.</p>
</blockquote>

<p>Lesson learned: If you <a href="http://code.mixpanel.com/2011/08/05/how-and-why-we-switched-from-erlang-to-python/">don’t like</a> the performance of your Erlang code, don’t be shy to speak up about it. Either you are doing something wrong or there is a bug in Erlang. Both things are fixable.</p>

<h2 id="scalability">Scalability</h2>

<blockquote>
  <p><a href="http://www.ericsson.com/ourportfolio/products/sgsn-mme">MME</a> is a thing in the backbone of mobile telephony network, it makes all mobile data work. And it’s written in Erlang. Smartphones wouldn’t be able to connect to the network at all without MME. Now, Ericsson’s got the biggest market share in the world for mobile base stations, for we do 40% of the total world market of 3G and CDMA and 60% of the world market for LTE and 4G. This gives us about 50% of the world market. That means Erlang’s controlling 50% of all smartphones world wide.</p>
</blockquote>

<p>That’s impressive, and at the same time it’s sad because people don’t know about it. People are talking about Twitter scale, Google scale, or other sorts of “web-scale”, but they don’t realize that most of the data Twitter and Google receive nowadays is comming through mobile network, which means most of Twitter and Google data is coming throug Erlang. Think about it.</p>

<p>On the other hand, those who see the power of Erlang get big competitive advantage.</p>

<blockquote>
  <p>At Erlang user conference somebody from gaming company came to me and said “Erlang’s great! We have it on our server, and we managed to get 3 million connections on it!” And he was overjoyed. It’s fantastic. I said “Great! You got to tell everybody…” And he said “No, no.” — “Why not?” — “Because we tell our competitiors we use Jigsaw.”</p>
</blockquote>

<blockquote>
  <p>There is no commercial advantage from using Ruby on Rails or Java or anything else. You might go to the conferences and swap battle stories and swap tips. But if you actually found something which is bloody better, you are not going to tell anybody, are you?</p>
</blockquote>

<p>Hm, maybe that’s why I cannot find any software company in Toronto that’s doing Erlang. Hey Toronto programmers, if you are programming in Erlang, please let me know — I won’t tell your competitors, I promise.</p>

<h2 id="broken-software">Broken software</h2>

<blockquote>
  <p>Most of my time as a programmer is spent fixing broken stuff that shouldn’t be broken. Whenever I’m trying to do something, it doesn’t work. I used to spend more than 50% of my time fixing trivial things, and the percentage of my time is increasing by year. If I look back 20 years ago, I din’t spend 50% of my time fixing broken software. The software that was available was a lot lot simpler, and it was written by engineers and teams and by small group of people, and it didn’t have errors in it. If we extrapolate this in 20 years time, it’s going to be even more software, and 90% of it will be completely broken, unless we find better ways of structuring it and gluing things together.</p>
</blockquote>

<p>So true. I have the same statistics. One third of my time I’m shaving software yaks, and another third I’m debugging protocols trying to figure out why my code is not working with another code.</p>

<h2 id="conference-driven-development">Conference driven development</h2>

<blockquote>
  <p>I’m giving a keynote at LambdaJam. I’ve written a <a href="http://lambdajam.com/sessions#armstrong">flushing title</a> but I haven’t written the talk yet.</p>
</blockquote>

<p>Lesson learned: Next time you want to give a talk at a conference, come up with a catchy title, and think about the talk itself later.</p>

<blockquote>
  <p>I deliberately give myself titles for stuff I know nothing about, and I implement it all. You know, Robert did that for Lua. You know why Lua got developed in Erlang? Robert was going to give a talk on writing DSL in Erlang. I remember him talking to me “I’m giving a talk on implementing DSL in Erlang.” I said “Oh, yeah.” And he said “I don’t know anything about it. I better implement Lua.”</p>
</blockquote>

<p>It’s a really good idea to submit a conference proposal for the stuff you want to learn. When the proposal is accepted, you don’t have a choice but go and study the thing. Otherwise you would procrastinate forever. I notice actually many people do that. Maybe I’ll do the same with Erlang, at some point.</p>

<h3 id="additional-resources">Additional Resources</h3>

<ul>
  <li>Joe Armstrong’s <a href="https://groups.google.com/forum/#!msg/erlang-programming/OiyGQ4UHqxw/HgGma01CGqYJ">reply</a> about efficiency of Erlang.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Code Retreat 2012]]></title>
    <link href="http://blog.ndpar.com/2012/12/09/code-retreat-2012/"/>
    <updated>2012-12-09T07:00:00-05:00</updated>
    <id>http://blog.ndpar.com/2012/12/09/code-retreat-2012</id>
    <content type="html"><![CDATA[<p>Yesterday was the Global Day of CodeRetreat. Software engineers around the globe met together to learn from each other.</p>

<p><img class="center" src="https://pbs.twimg.com/media/A9mptOCCAAE0d7z.jpg" title="CR2012 1" ></p>

<p>There were several sessions where people were pair-programming <a href="http://en.wikipedia.org/wiki/Conway's_Game_of_Life">Conway’s Game of Life</a>.</p>

<p><img class="center" src="https://pbs.twimg.com/media/A9nZYcTCQAEVtkP.jpg" title="CR2012 2" ></p>

<p>Each session you had to choose a new partner, so that both of you can learn something new.</p>

<p><img class="center" src="https://pbs.twimg.com/media/A9n_aHzCcAARnkJ.jpg" title="CR2012 3" ></p>

<p>During the first session my partner and I decided to implement the Game in Java, mainly because it was the language she was most comfortable with. We implemented the procedural solution using two-dimensional array and nested loops. At that moment that was the only solution I could think of. The main challenge was to cover all edge cases and fix all <code>ArrayIndexOutOfBoundsException</code>s. Java is fairly verbose language, and with nested loops and if-else statements the final solution was pretty hard to read. You can see <a href="http://rosettacode.org/wiki/Conway's_Game_of_Life#Java">here</a> how it might look like.</p>

<p>First session was a warmup, during which most people realized that programming arrays is a tedious work. For the second session my new partner suggested an object-oriented approach, where you would operate on Cell objects that would encapsulate coordinates on the grid. In this case you move the game logic from the grid to the cell, making it easier to calculate a new state. This was my first acquaintance with C#. Interesting language — basically, Java with lambdas. Here is an <a href="http://rosettacode.org/wiki/Conway's_Game_of_Life#C.23">example</a> of C# implementation. Our solution was very similar.</p>

<p>While the first session’s data structure was array of booleans, on the second session it was replaced by a list of objects. The next step would be to relax the data structure even further. We decided to experiment with un-ordered set of coordinate pairs. For language we chose Clojure. Although we didn’t finish the implementation, by the end of the session we had a clear picture how to solve the problem in functional style.</p>

<p>On the fourth session the facilitators put an interesting constraint: the coding must be done in absolute silence. That was the most amazing experience of the day. Before we started I thought we couldn’t accomplish much without talking. As it turned out, we could. The key of effective silent coding is to use the tools which both partners are familiar with. In our case we both were advanced users of Vim, and we knew Lisp languages. Our Clojure implementation was based on map/filter/reduce approach and spanned 20 lines of code. After the session <a href="http://langnostic.blogspot.com">Leo</a> showed me Christophe Grand’s <a href="http://clj-me.cgrand.net/2011/08/19/conways-game-of-life/">7-line solution</a> based on list comprehensions. It is so wonderful that I want to post it here</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>life.clj </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='clojure'><span class='line'><span class="p">(</span><span class="kd">defn </span><span class="nv">neighbours</span> <span class="p">[[</span><span class="nv">x</span> <span class="nv">y</span><span class="p">]]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">dx</span> <span class="p">[</span><span class="mi">-1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]</span> <span class="nv">dy</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">zero? </span><span class="nv">dx</span><span class="p">)</span> <span class="p">[</span><span class="mi">-1</span> <span class="mi">1</span><span class="p">]</span> <span class="p">[</span><span class="mi">-1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">])]</span>
</span><span class='line'>    <span class="p">[(</span><span class="nb">+ </span><span class="nv">dx</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">dy</span> <span class="nv">y</span><span class="p">)]))</span><span class="nv">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">&lt;p&gt;</span><span class="p">(</span><span class="kd">defn </span><span class="nv">step</span> <span class="p">[</span><span class="nv">cells</span><span class="p">]</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">set </span><span class="p">(</span><span class="nb">for </span><span class="p">[[</span><span class="nv">loc</span> <span class="nv">n</span><span class="p">]</span> <span class="p">(</span><span class="nf">frequencies</span> <span class="p">(</span><span class="nb">mapcat </span><span class="nv">neighbours</span> <span class="nv">cells</span><span class="p">))</span>
</span><span class='line'>             <span class="ss">:when</span> <span class="p">(</span><span class="nb">or </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">3</span><span class="p">)</span> <span class="p">(</span><span class="nb">and </span><span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nf">cells</span> <span class="nv">loc</span><span class="p">)))]</span>
</span><span class='line'>         <span class="nv">loc</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>For the last session we chose Erlang. Because we already knew how to implement the functional solution, that was just an exercise of translating Clojure code into Erlang. Unfortunately we didn’t find an equivalent of <code>frequencies</code> function in the standard library, so we implemented it ourselves. Other than that, the Erlang code is almost identical to Clojure.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>life.erl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='erlang'><span class='line'><span class="nf">neighbours</span><span class="p">({</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span><span class="p">})</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="p">[{</span><span class="nv">X</span> <span class="o">+</span> <span class="nv">DX</span><span class="p">,</span> <span class="nv">Y</span> <span class="o">+</span> <span class="nv">DY</span><span class="p">}</span> <span class="p">||</span> <span class="nv">DX</span> <span class="err">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">-</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="nv">DY</span> <span class="err">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">-</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">{</span><span class="nv">DX</span><span class="p">,</span> <span class="nv">DY</span><span class="p">}</span> <span class="o">=/=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">}].</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">step</span><span class="p">(</span><span class="nv">Cells</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">Nbs</span> <span class="o">=</span> <span class="nn">lists</span><span class="p">:</span><span class="nf">flatmap</span><span class="p">(</span><span class="k">fun</span> <span class="n">neighbours</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="nn">sets</span><span class="p">:</span><span class="nf">to_list</span><span class="p">(</span><span class="nv">Cells</span><span class="p">)),</span>
</span><span class='line'>    <span class="nv">NewCells</span> <span class="o">=</span> <span class="p">[</span><span class="nv">C</span> <span class="p">||</span> <span class="p">{</span><span class="nv">C</span><span class="p">,</span> <span class="nv">N</span><span class="p">}</span> <span class="err">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">-</span> <span class="nn">dict</span><span class="p">:</span><span class="nf">to_list</span><span class="p">(</span><span class="n">frequencies</span><span class="p">(</span><span class="nv">Nbs</span><span class="p">)),</span>
</span><span class='line'>                     <span class="p">(</span><span class="nv">N</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">orelse</span> <span class="p">((</span><span class="nv">N</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">andalso</span> <span class="nn">sets</span><span class="p">:</span><span class="nf">is_element</span><span class="p">(</span><span class="nv">C</span><span class="p">,</span> <span class="nv">Cells</span><span class="p">))],</span>
</span><span class='line'>    <span class="nn">sets</span><span class="p">:</span><span class="nf">from_list</span><span class="p">(</span><span class="nv">NewCells</span><span class="p">).</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">frequencies</span><span class="p">(</span><span class="nv">List</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">frequencies</span><span class="p">(</span><span class="nv">List</span><span class="p">,</span> <span class="nn">dict</span><span class="p">:</span><span class="nf">new</span><span class="p">()).</span>
</span><span class='line'><span class="nf">frequencies</span><span class="p">([],</span> <span class="nv">Acc</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="nv">Acc</span><span class="p">;</span>
</span><span class='line'><span class="nf">frequencies</span><span class="p">([</span><span class="nv">X</span><span class="p">|</span><span class="nv">Xs</span><span class="p">],</span> <span class="nv">Acc</span><span class="p">)</span> <span class="o">-</span><span class="err">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">frequencies</span><span class="p">(</span><span class="nv">Xs</span><span class="p">,</span> <span class="nn">dict</span><span class="p">:</span><span class="nf">update_counter</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">Acc</span><span class="p">)).</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2 id="summary">Summary</h2>

<p>During this day I learnt a lot: new language, new abstractions, new techniques, new ways of communication, new ideas. I met bunch of smart people. I was so overwhelmed with all this cool stuff that I had to write this blog post to offload it from my head.</p>

<p>If you are a programmer and you’ve never been to CodeRetreat, I strongly encourage you to do it next year. It’s an exciting experience.</p>

<p>I want to thank all the people who organized and participated in this event.</p>

<h3 id="photo-credits">Photo Credits</h3>

<ul>
  <li>Michael DiBernardo <a href="https://twitter.com/mdibernardo/status/277439446381625345/photo/1">[1]</a></li>
  <li>Kunal Gupta <a href="https://twitter.com/kunalfrompolar/status/277491865991921664/photo/1">[2]</a></li>
  <li>Carlo Barrettara <a href="https://twitter.com/barrettara/status/277533676273823746/photo/1">[3]</a></li>
</ul>

]]></content>
  </entry>
  
</feed>
